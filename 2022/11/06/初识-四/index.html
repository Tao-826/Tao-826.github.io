<!DOCTYPE html>
<html lang=zh>
<head>
  <meta charset="utf-8">
  
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, minimum-scale=1, user-scalable=no, minimal-ui">
  <meta name="renderer" content="webkit">
  <meta http-equiv="Cache-Control" content="no-transform" />
  <meta http-equiv="Cache-Control" content="no-siteapp" />
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  <meta name="format-detection" content="telephone=no,email=no,adress=no">
  <!-- Color theme for statusbar -->
  <meta name="theme-color" content="#000000" />
  <!-- 强制页面在当前窗口以独立页面显示,防止别人在框架里调用页面 -->
  <meta http-equiv="window-target" content="_top" />
  
  
  <title>初识(四) | Hexo</title>
  <meta name="description" content="Ajax1- URL地址URL(UniformResourceLocator) 中文叫统一资源定位符，用于标识互联网上每个资源的唯一存放位置。 浏览器只有通过URL地址，才能正确定位资源的存放位置，从而成功访问到对应的资源。 1.1 URL地址一般由三部分组成：1.客户端与服务器之间的通信协议 2.存有该资源的服务器名称 3.资源在服务器上具体的存放位置   1.2 资源的请求方式客户端请求服务器">
<meta property="og:type" content="article">
<meta property="og:title" content="初识(四)">
<meta property="og:url" content="http://example.com/2022/11/06/%E5%88%9D%E8%AF%86-%E5%9B%9B/index.html">
<meta property="og:site_name" content="Hexo">
<meta property="og:description" content="Ajax1- URL地址URL(UniformResourceLocator) 中文叫统一资源定位符，用于标识互联网上每个资源的唯一存放位置。 浏览器只有通过URL地址，才能正确定位资源的存放位置，从而成功访问到对应的资源。 1.1 URL地址一般由三部分组成：1.客户端与服务器之间的通信协议 2.存有该资源的服务器名称 3.资源在服务器上具体的存放位置   1.2 资源的请求方式客户端请求服务器">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="e:\%E8%83%BD%E6%94%BE\%E5%89%8D%E7%AB%AF\%E6%88%AA%E5%9B%BE\Ajax\URL%E7%BB%84%E6%88%90.png">
<meta property="og:image" content="e:\%E8%83%BD%E6%94%BE\%E5%89%8D%E7%AB%AF\%E6%88%AA%E5%9B%BE\Ajax\%E5%AE%A2%E6%88%B7%E7%AB%AF%E5%92%8C%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%9A%84%E9%80%9A%E4%BF%A1%E8%BF%87%E7%A8%8B.png">
<meta property="og:image" content="e:\%E8%83%BD%E6%94%BE\%E5%89%8D%E7%AB%AF\%E6%88%AA%E5%9B%BE\Ajax\jQuery%E7%9B%91%E5%90%AC%E8%A1%A8%E5%8D%95.png">
<meta property="og:image" content="e:\%E8%83%BD%E6%94%BE\%E5%89%8D%E7%AB%AF\%E6%88%AA%E5%9B%BE\Ajax\%E9%98%BB%E6%AD%A2%E9%BB%98%E8%AE%A4%E8%A1%8C%E4%B8%BA.png">
<meta property="og:image" content="e:\%E8%83%BD%E6%94%BE\%E5%89%8D%E7%AB%AF\%E6%88%AA%E5%9B%BE\Ajax\%E6%A8%A1%E6%9D%BF%E5%BC%95%E6%93%8E.png">
<meta property="og:image" content="e:\%E8%83%BD%E6%94%BE\%E5%89%8D%E7%AB%AF\%E6%88%AA%E5%9B%BE\Ajax\xhr%E5%B1%9E%E6%80%A7.png">
<meta property="og:image" content="e:\%E8%83%BD%E6%94%BE\%E5%89%8D%E7%AB%AF\%E6%88%AA%E5%9B%BE\Ajax\get%E8%AF%B7%E6%B1%82%E6%90%BA%E5%B8%A6%E5%8F%82%E6%95%B0%E7%9A%84%E6%9C%AC%E8%B4%A8.png">
<meta property="article:published_time" content="2022-11-06T03:43:20.000Z">
<meta property="article:modified_time" content="2022-11-06T04:10:23.416Z">
<meta property="article:author" content="John Doe">
<meta property="article:tag" content="Ajax">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="e:\%E8%83%BD%E6%94%BE\%E5%89%8D%E7%AB%AF\%E6%88%AA%E5%9B%BE\Ajax\URL%E7%BB%84%E6%88%90.png">
  <!-- Canonical links -->
  <link rel="canonical" href="http://example.com/2022/11/06/%E5%88%9D%E8%AF%86-%E5%9B%9B/index.html">
  
    <link rel="alternate" href="/atom.xml" title="Hexo" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png" type="image/x-icon">
  
  
<link rel="stylesheet" href="/css/style.css">

  
  
  
  
<meta name="generator" content="Hexo 6.3.0"></head>


<body class="main-center" itemscope itemtype="http://schema.org/WebPage">
  <header class="header" itemscope itemtype="http://schema.org/WPHeader">
  <div class="slimContent">
    <div class="navbar-header">
      
      
      <div class="profile-block text-center">
        <a id="avatar" href="https://github.com/cofess" target="_blank">
          <img class="img-circle img-rotate" src="/images/portrait.jpg" width="200" height="200">
        </a>
        <h2 id="name" class="hidden-xs hidden-sm">十七</h2>
        <h3 id="title" class="hidden-xs hidden-sm hidden-md">前端开发工程师</h3>
        <small id="location" class="text-muted hidden-xs hidden-sm"><i class="icon icon-map-marker"></i> hunan, China</small>
      </div>
      
      <div class="search" id="search-form-wrap">

    <form class="search-form sidebar-form">
        <div class="input-group">
            <input type="text" class="search-form-input form-control" placeholder="搜索" />
            <span class="input-group-btn">
                <button type="submit" class="search-form-submit btn btn-flat" onclick="return false;"><i class="icon icon-search"></i></button>
            </span>
        </div>
    </form>
    <div class="ins-search">
  <div class="ins-search-mask"></div>
  <div class="ins-search-container">
    <div class="ins-input-wrapper">
      <input type="text" class="ins-search-input" placeholder="想要查找什么..." x-webkit-speech />
      <button type="button" class="close ins-close ins-selectable" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">×</span></button>
    </div>
    <div class="ins-section-wrapper">
      <div class="ins-section-container"></div>
    </div>
  </div>
</div>


</div>
      <button class="navbar-toggle collapsed" type="button" data-toggle="collapse" data-target="#main-navbar" aria-controls="main-navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
    </div>
    <nav id="main-navbar" class="collapse navbar-collapse" itemscope itemtype="http://schema.org/SiteNavigationElement" role="navigation">
      <ul class="nav navbar-nav main-nav ">
        
        
        <li class="menu-item menu-item-home">
          <a href="/.">
            
            <i class="icon icon-home-fill"></i>
            
            <span class="menu-title">首页</span>
          </a>
        </li>
        
        
        <li class="menu-item menu-item-archives">
          <a href="/archives">
            
            <i class="icon icon-archives-fill"></i>
            
            <span class="menu-title">归档</span>
          </a>
        </li>
        
        
        <li class="menu-item menu-item-categories">
          <a href="/categories">
            
            <i class="icon icon-folder"></i>
            
            <span class="menu-title">分类</span>
          </a>
        </li>
        
        
        <li class="menu-item menu-item-tags">
          <a href="/tags">
            
            <i class="icon icon-tags"></i>
            
            <span class="menu-title">标签</span>
          </a>
        </li>
        
        
        <li class="menu-item menu-item-repository">
          <a href="/repository">
            
            <i class="icon icon-project"></i>
            
            <span class="menu-title">项目</span>
          </a>
        </li>
        
        
        <li class="menu-item menu-item-books">
          <a href="/books">
            
            <i class="icon icon-book-fill"></i>
            
            <span class="menu-title">书单</span>
          </a>
        </li>
        
        
        <li class="menu-item menu-item-links">
          <a href="/links">
            
            <i class="icon icon-friendship"></i>
            
            <span class="menu-title">友链</span>
          </a>
        </li>
        
        
        <li class="menu-item menu-item-about">
          <a href="/about">
            
            <i class="icon icon-cup-fill"></i>
            
            <span class="menu-title">关于</span>
          </a>
        </li>
        
      </ul>
      
	
    <ul class="social-links">
    	
        <li><a href="https://github.com/cofess" target="_blank" title="Github" data-toggle=tooltip data-placement=top><i class="icon icon-github"></i></a></li>
        
        <li><a href="http://weibo.com/cofess" target="_blank" title="Weibo" data-toggle=tooltip data-placement=top><i class="icon icon-weibo"></i></a></li>
        
        <li><a href="https://twitter.com/iwebued" target="_blank" title="Twitter" data-toggle=tooltip data-placement=top><i class="icon icon-twitter"></i></a></li>
        
        <li><a href="https://www.behance.net/cofess" target="_blank" title="Behance" data-toggle=tooltip data-placement=top><i class="icon icon-behance"></i></a></li>
        
        <li><a href="/atom.xml" target="_blank" title="Rss" data-toggle=tooltip data-placement=top><i class="icon icon-rss"></i></a></li>
        
    </ul>

    </nav>
  </div>
</header>

  
    <aside class="sidebar" itemscope itemtype="http://schema.org/WPSideBar">
  <div class="slimContent">
    
      <div class="widget">
    <h3 class="widget-title">公告</h3>
    <div class="widget-body">
        <div id="board">
            <div class="content">
                <p>欢迎交流与分享经验!</p>
            </div>
        </div>
    </div>
</div>

    
      
  <div class="widget">
    <h3 class="widget-title">分类</h3>
    <div class="widget-body">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/%E8%B5%84%E6%96%99/">资料</a><span class="category-list-count">12</span></li></ul>
    </div>
  </div>


    
      
  <div class="widget">
    <h3 class="widget-title">标签</h3>
    <div class="widget-body">
      <ul class="tag-list" itemprop="keywords"><li class="tag-list-item"><a class="tag-list-link" href="/tags/Ajax/" rel="tag">Ajax</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/CSS/" rel="tag">CSS</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Node/" rel="tag">Node</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Vue/" rel="tag">Vue</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Vuex/" rel="tag">Vuex</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Vue%E5%9F%BA%E7%A1%80/" rel="tag">Vue基础</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Web-Api/" rel="tag">Web Api</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Webpack/" rel="tag">Webpack</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/jQuery/" rel="tag">jQuery</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/uni-app/" rel="tag">uni-app</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%BE%AE%E4%BF%A1%E5%B0%8F%E7%A8%8B%E5%BA%8F/" rel="tag">微信小程序</a><span class="tag-list-count">1</span></li></ul>
    </div>
  </div>


    
      
  <div class="widget">
    <h3 class="widget-title">标签云</h3>
    <div class="widget-body tagcloud">
      <a href="/tags/Ajax/" style="font-size: 13px;">Ajax</a> <a href="/tags/CSS/" style="font-size: 14px;">CSS</a> <a href="/tags/Node/" style="font-size: 13px;">Node</a> <a href="/tags/Vue/" style="font-size: 13px;">Vue</a> <a href="/tags/Vuex/" style="font-size: 13px;">Vuex</a> <a href="/tags/Vue%E5%9F%BA%E7%A1%80/" style="font-size: 13px;">Vue基础</a> <a href="/tags/Web-Api/" style="font-size: 13px;">Web Api</a> <a href="/tags/Webpack/" style="font-size: 13px;">Webpack</a> <a href="/tags/jQuery/" style="font-size: 13px;">jQuery</a> <a href="/tags/uni-app/" style="font-size: 13px;">uni-app</a> <a href="/tags/%E5%BE%AE%E4%BF%A1%E5%B0%8F%E7%A8%8B%E5%BA%8F/" style="font-size: 13px;">微信小程序</a>
    </div>
  </div>

    
      
  <div class="widget">
    <h3 class="widget-title">归档</h3>
    <div class="widget-body">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/11/">十一月 2022</a><span class="archive-list-count">13</span></li></ul>
    </div>
  </div>


    
      
  <div class="widget">
    <h3 class="widget-title">最新文章</h3>
    <div class="widget-body">
      <ul class="recent-post-list list-unstyled no-thumbnail">
        
          <li>
            
            <div class="item-inner">
              <p class="item-category">
                <a class="category-link" href="/categories/%E8%B5%84%E6%96%99/">资料</a>
              </p>
              <p class="item-title">
                <a href="/2022/11/06/%E5%88%9D%E8%AF%86-%E5%8D%81%E4%BA%8C/" class="title">初识(十二)</a>
              </p>
              <p class="item-date">
                <time datetime="2022-11-06T03:53:36.000Z" itemprop="datePublished">2022-11-06</time>
              </p>
            </div>
          </li>
          
          <li>
            
            <div class="item-inner">
              <p class="item-category">
                <a class="category-link" href="/categories/%E8%B5%84%E6%96%99/">资料</a>
              </p>
              <p class="item-title">
                <a href="/2022/11/06/%E5%88%9D%E8%AF%86-%E5%8D%81%E4%B8%80/" class="title">初识(十一)</a>
              </p>
              <p class="item-date">
                <time datetime="2022-11-06T03:53:29.000Z" itemprop="datePublished">2022-11-06</time>
              </p>
            </div>
          </li>
          
          <li>
            
            <div class="item-inner">
              <p class="item-category">
                <a class="category-link" href="/categories/%E8%B5%84%E6%96%99/">资料</a>
              </p>
              <p class="item-title">
                <a href="/2022/11/06/%E5%88%9D%E8%AF%86-%E5%8D%81/" class="title">初识(十)</a>
              </p>
              <p class="item-date">
                <time datetime="2022-11-06T03:51:31.000Z" itemprop="datePublished">2022-11-06</time>
              </p>
            </div>
          </li>
          
          <li>
            
            <div class="item-inner">
              <p class="item-category">
                <a class="category-link" href="/categories/%E8%B5%84%E6%96%99/">资料</a>
              </p>
              <p class="item-title">
                <a href="/2022/11/06/%E5%88%9D%E8%AF%86-%E4%B9%9D/" class="title">初识(九)</a>
              </p>
              <p class="item-date">
                <time datetime="2022-11-06T03:51:22.000Z" itemprop="datePublished">2022-11-06</time>
              </p>
            </div>
          </li>
          
          <li>
            
            <div class="item-inner">
              <p class="item-category">
                <a class="category-link" href="/categories/%E8%B5%84%E6%96%99/">资料</a>
              </p>
              <p class="item-title">
                <a href="/2022/11/06/%E5%88%9D%E8%AF%86-%E5%85%AB/" class="title">初识(八)</a>
              </p>
              <p class="item-date">
                <time datetime="2022-11-06T03:49:12.000Z" itemprop="datePublished">2022-11-06</time>
              </p>
            </div>
          </li>
          
      </ul>
    </div>
  </div>
  

    
  </div>
</aside>

  
  
<main class="main" role="main">
  <div class="content">
  <article id="post-初识-四" class="article article-type-post" itemscope itemtype="http://schema.org/BlogPosting">
    
    <div class="article-header">
      
        
  
    <h1 class="article-title" itemprop="name">
      初识(四)
    </h1>
  

      
      <div class="article-meta">
        <span class="article-date">
    <i class="icon icon-calendar-check"></i>
	<a href="/2022/11/06/%E5%88%9D%E8%AF%86-%E5%9B%9B/" class="article-date">
	  <time datetime="2022-11-06T03:43:20.000Z" itemprop="datePublished">2022-11-06</time>
	</a>
</span>
        
  <span class="article-category">
    <i class="icon icon-folder"></i>
    <a class="article-category-link" href="/categories/%E8%B5%84%E6%96%99/">资料</a>
  </span>

        
  <span class="article-tag">
    <i class="icon icon-tags"></i>
	<a class="article-tag-link-link" href="/tags/Ajax/" rel="tag">Ajax</a>
  </span>


        

        <span class="post-comment"><i class="icon icon-comment"></i> <a href="/2022/11/06/%E5%88%9D%E8%AF%86-%E5%9B%9B/#comments" class="article-comment-link">评论</a></span>
        
      </div>
    </div>
    <div class="article-entry marked-body" itemprop="articleBody">
      
        <h2 id="Ajax"><a href="#Ajax" class="headerlink" title="Ajax"></a>Ajax</h2><h3 id="1-URL地址"><a href="#1-URL地址" class="headerlink" title="1- URL地址"></a>1- URL地址</h3><p>URL(UniformResourceLocator) 中文叫统一资源定位符，用于标识互联网上每个资源的唯一存放位置。</p>
<p>浏览器只有通过URL地址，才能正确定位资源的存放位置，从而成功访问到对应的资源。</p>
<h4 id="1-1-URL地址一般由三部分组成："><a href="#1-1-URL地址一般由三部分组成：" class="headerlink" title="1.1 URL地址一般由三部分组成："></a>1.1 URL地址一般由三部分组成：</h4><p>1.客户端与服务器之间的通信协议</p>
<p>2.存有该资源的服务器名称</p>
<p>3.资源在服务器上具体的存放位置</p>
<p><img src="E:\能放\前端\截图\Ajax\URL组成.png" alt="URL组成"></p>
<p><img src="E:\能放\前端\截图\Ajax\客户端和服务器的通信过程.png" alt="客户端和服务器的通信过程"></p>
<h4 id="1-2-资源的请求方式"><a href="#1-2-资源的请求方式" class="headerlink" title="1.2 资源的请求方式"></a>1.2 资源的请求方式</h4><p>客户端请求服务器时，请求的方式有很多种，最常见的两种方式分别为get和post请求。</p>
<p>1.get 请求通常用于获取服务端资源（向服务器要资源）</p>
<p>例如：根据URL地址,从服务器获取HTML文件、css文件、js文件、图片文件、数据资源等</p>
<p>2.post请求通常用于向服务器提交数据（往服务器发送资源）</p>
<p>例如：登录时向服务器提交的登录信息、注册时向服务器提交的注册信息、添加用户时向服务器提交的用户信息等各种数据提交操作。</p>
<h3 id="2-Ajax"><a href="#2-Ajax" class="headerlink" title="2- Ajax"></a>2- Ajax</h3><p>Ajax全称是：Asynchronous Javascript And XML（异步JavaScript和<a target="_blank" rel="noopener" href="https://baike.baidu.com/item/XML/86251">XML</a>）</p>
<p>通俗的理解：在网页中利用<a target="_blank" rel="noopener" href="https://baike.baidu.com/item/XMLHttpRequest">XMLHttpRequest</a> 对象和服务器进行数据交互的方式，就是Ajax。</p>
<p>Ajax能让我们轻松实线网页与服务器之间的数据交互。</p>
<p>Ajax的应用场景</p>
<p>用户名检测：注册用户时，通过Ajax的形式，动态检测用户名是否被占用</p>
<p>搜索提示：当输入搜索关键字时，通过Ajax的形态，动态加载搜索提示列表</p>
<h3 id="3-jQuery中的Ajax"><a href="#3-jQuery中的Ajax" class="headerlink" title="3- jQuery中的Ajax"></a>3- jQuery中的Ajax</h3><h4 id="3-1-get-函数的语法"><a href="#3-1-get-函数的语法" class="headerlink" title="3.1 $.get()函数的语法"></a>3.1 $.get()函数的语法</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$.<span class="title function_">get</span>(url,[data],[callback])</span><br></pre></td></tr></table></figure>

<p><strong>url:请求的资源地址（string）		必写</strong></p>
<p>data：请求资源期间要携带的参数（object）		可写</p>
<p>callback：请求成功时的回调函数（function）		可写</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">$.<span class="title function_">get</span>(<span class="string">&#x27;http://ajax-base-api-t.itheima.net/api/getbooks&#x27;</span>, &#123; <span class="attr">author</span>: <span class="string">&#x27;曹雪芹&#x27;</span> &#125;, <span class="keyword">function</span> (<span class="params">res</span>) &#123;</span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">log</span>(res)</span><br><span class="line">    &#125;)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">$.<span class="title function_">get</span>(&#123;</span><br><span class="line">      <span class="attr">url</span>: <span class="string">&#x27;http://ajax-base-api-t.itheima.net/api/getbooks&#x27;</span>,</span><br><span class="line">      <span class="attr">data</span>: &#123;</span><br><span class="line">        <span class="attr">id</span>: <span class="number">1527</span></span><br><span class="line">      &#125;</span><br><span class="line">    &#125;, <span class="keyword">function</span> (<span class="params">res</span>) &#123;</span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">log</span>(res)</span><br><span class="line">    &#125;)</span><br></pre></td></tr></table></figure>

<h4 id="3-2-post-语法"><a href="#3-2-post-语法" class="headerlink" title="3.2 $.post()语法"></a>3.2 $.post()语法</h4><p>用来发起 post 请求，从而向服务器提交数据</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$.<span class="title function_">post</span>(url,[data],[callback])</span><br></pre></td></tr></table></figure>

<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">$.<span class="title function_">post</span>(<span class="string">&quot;http://ajax-base-api-t.itheima.net/api/addbook&quot;</span>,&#123;</span><br><span class="line">      <span class="attr">bookname</span>:<span class="string">&#x27;水浒传&#x27;</span>,</span><br><span class="line">      <span class="attr">author</span>:<span class="string">&#x27;吴承恩&#x27;</span>,</span><br><span class="line">      <span class="attr">publisher</span>:<span class="string">&#x27;北京出版社&#x27;</span></span><br><span class="line">    &#125;,<span class="keyword">function</span>(<span class="params">res</span>)&#123;</span><br><span class="line">     <span class="variable language_">console</span>.<span class="title function_">log</span>(res)</span><br><span class="line">    &#125;)</span><br><span class="line"></span><br><span class="line">$.<span class="title function_">post</span>(&#123;</span><br><span class="line">      <span class="attr">url</span>: <span class="string">&#x27;http://ajax-base-api-t.itheima.net/api/getbooks&#x27;</span>,</span><br><span class="line">      <span class="attr">data</span>: &#123;</span><br><span class="line">      <span class="attr">bookname</span>:<span class="string">&#x27;水浒传&#x27;</span>,</span><br><span class="line">      <span class="attr">author</span>:<span class="string">&#x27;吴承恩&#x27;</span>,</span><br><span class="line">      <span class="attr">publisher</span>:<span class="string">&#x27;北京出版社&#x27;</span></span><br><span class="line">      &#125;</span><br><span class="line">    &#125;, <span class="keyword">function</span> (<span class="params">res</span>) &#123;</span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">log</span>(res)</span><br><span class="line">    &#125;)</span><br></pre></td></tr></table></figure>

<h4 id="3-3-ajax函数"><a href="#3-3-ajax函数" class="headerlink" title="3.3 $.ajax函数"></a>3.3 $.ajax函数</h4><p>是一个功能比较综合的函数，它允许我们对 Ajax 请求进行更详细的配置。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// $.ajax(url,[settings])   settings 配置项（对象）</span></span><br><span class="line">    <span class="comment">// &#123;</span></span><br><span class="line">    <span class="comment">//   url 请求的地址</span></span><br><span class="line">    <span class="comment">//   type 请求的方式</span></span><br><span class="line">    <span class="comment">//   data 请求需要的参数</span></span><br><span class="line">    <span class="comment">//   success 成功的回调函数</span></span><br><span class="line">    <span class="comment">// &#125;</span></span><br><span class="line">    $.<span class="title function_">ajax</span>(&#123;</span><br><span class="line">      <span class="attr">url</span>: <span class="string">&#x27;http://ajax-base-api-t.itheima.net/api/getbooks&#x27;</span>,</span><br><span class="line">      <span class="attr">type</span>: <span class="string">&#x27;get&#x27;</span>,</span><br><span class="line">      <span class="attr">data</span>: &#123;</span><br><span class="line">        <span class="attr">id</span>: <span class="number">5</span></span><br><span class="line">      &#125;,</span><br><span class="line">      <span class="title function_">success</span>(<span class="params">res</span>) &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(res)</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;)</span><br></pre></td></tr></table></figure>

<h3 id="4-接口"><a href="#4-接口" class="headerlink" title="4-接口"></a>4-接口</h3><p>使用 Ajax 请求数据时，被请求的 URL 地址，就叫做 数据接口（简称接口）。同时，每个接口必须有请求方式。</p>
<h4 id="4-1接口测试"><a href="#4-1接口测试" class="headerlink" title="4.1接口测试"></a>4.1接口测试</h4><p>为了验证接口是否被正常被访问，我们常常需要使用接口测试工具，来对数据接口进行检测</p>
<p>好处：接口测试工具能让我们在 不写任何代码 的情况下，对接口进行 调用 和 测试常用的就是：PostMan</p>
<h4 id="4-2接口文档"><a href="#4-2接口文档" class="headerlink" title="4.2接口文档"></a>4.2接口文档</h4><p>接口文档，顾名思义就是 接口的说明文档，它是我们调用接口的依据。好的接口文档包含了对 接口URL，参数 以及 输出内容 的说明，我们参照接口文档就能方便的知道接口的作用，以及接口如何进行调用</p>
<p>接口文档的组成部分</p>
<p>接口文档可以包含很多信息，也可以按需进行精简，不过，一个合格的接口文档，应该包含以下6项内容，从而为接口的调用提供依据：</p>
<p><strong>接口名称：</strong>用来标识各个接口的简单说明，如 登录接口，获取图书列表接口等</p>
<p><strong>接口URL：</strong>接口的调用地址</p>
<p><strong>调用方式：</strong>接口的调用方式，如 GET 或者 POST</p>
<p><strong>参数格式：</strong>接口需要传递的参数，每个参数必须包含 参数名称、参数类型、是否必选、参数说明这4项内容</p>
<p><strong>响应格式：</strong>接口的返回值的详细描述，一般包含数据名称、数据类型、说明3项内容</p>
<p><strong>返回示例（可选）：</strong>通过对象的形式，列举服务器返回数据的结构</p>
<h3 id="5-form表单"><a href="#5-form表单" class="headerlink" title="5-form表单"></a>5-form表单</h3><p>表单在网页中主要负责 <strong>数据采集功能</strong>。HTML中<code>&lt;form&gt;</code>标签，就是用于采集用户输入的信息，并通过 <code>&lt;form&gt; </code>标签的提交操作，把采集的信息提交到服务器端进行处理</p>
<h4 id="5-1标签的属性"><a href="#5-1标签的属性" class="headerlink" title="5.1标签的属性"></a>5.1标签的属性</h4><h5 id="5-1-1-action-属性"><a href="#5-1-1-action-属性" class="headerlink" title="5.1.1**action** 属性"></a>5.1.1**<code>action</code>** 属性</h5><p>用来规定当提交表单时，<strong>向何处发送表单数据</strong>。</p>
<p><code>action</code> 属性的值应该是后端提供的一个URL地址，这个URL地址专门负责接收表单提交过来的数据。</p>
<p>当 <code>&lt;form&gt;</code>表单在未制定 <code>action</code> 属性值的清空下，<code>action</code>的默认值为当前页面的 <code>URL</code> 地址</p>
<p><strong>注意:</strong> 当提交表单后，会立即跳转到 <code>action</code> 属性指定的 <code>URL</code> 地址。</p>
<h5 id="5-1-2-target-属性"><a href="#5-1-2-target-属性" class="headerlink" title="5.1.2**target** 属性"></a>5.1.2**<code>target</code>** 属性</h5><p>用来规定 在何处打开 <code>action URL</code></p>
<p>它的可选值有5个，默认情况下，target的值是 _self，表示在相同的框架中打开 action URL</p>
<p>_blank：在新窗口打开</p>
<p>_self：默认。在相同的框架上打开</p>
<p>_parent：在父框架集中打开</p>
<p>_top：在整个窗口打开</p>
<p>framename：在指定的框架上打开</p>
<h5 id="5-1-3method属性"><a href="#5-1-3method属性" class="headerlink" title="5.1.3method属性"></a>5.1.3<code>method属性</code></h5><p><code>method</code> 属性用来规定 <strong>以何种方式</strong> 把表单数据提交到 action URL</p>
<p>它的可选值有两个，分别是 <code>get</code> 和 <code>post</code></p>
<p>默认情况下，<code>method</code>的值为 <code>get</code>， 表示通过<code>URL</code>地址的形式，把表单数据提交到 <code>action URL</code></p>
<p><strong>注意：</strong></p>
<ul>
<li>get 方式适合用来提交<strong>少量的</strong>，<strong>简单的</strong>数据</li>
<li>post 方式适合用来提交<strong>大量的</strong>，<strong>复杂的</strong>，或包含<strong>文件上传</strong>的数据</li>
</ul>
<h5 id="5-1-4enctype属性"><a href="#5-1-4enctype属性" class="headerlink" title="5.1.4enctype属性"></a>5.1.4<code>enctype属性</code></h5><p><code>enctype</code>属性用来规定在 <strong>发送表单数据之前如何对数据进行编码</strong></p>
<p>它的可选值有三个，默认情况下，<code>enctype</code>的值为 <code>application/x-www-form-urlencoded</code>，表示在发送前编码的所有字符。</p>
<h5 id="5-1-5表单同步提交的缺点"><a href="#5-1-5表单同步提交的缺点" class="headerlink" title="5.1.5表单同步提交的缺点"></a>5.1.5表单同步提交的缺点</h5><ul>
<li><code>&lt;form&gt;</code> 表单同步提交后，整个页面会发生跳转，<strong>跳转到 action URL 所指向的地址</strong>，用户体验很差</li>
<li><code>&lt;form&gt;</code> 表单同步提交后，页面之前的状态和数据会丢失</li>
</ul>
<p><strong>如何解决呢？</strong></p>
<p><strong>表单只复杂采集数据，Ajax负责将数据提交到服务器</strong></p>
<p>jQuery中监听表单提交事件的两种方式 .submit &#x2F; .on</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">$(<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">      <span class="comment">// 绑定提交事件</span></span><br><span class="line">      $(<span class="string">&#x27;form&#x27;</span>).<span class="title function_">submit</span>(<span class="keyword">function</span>(<span class="params">e</span>)&#123;</span><br><span class="line">        <span class="comment">// 阻止默认行为</span></span><br><span class="line">        <span class="comment">// e.preventDefault()</span></span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="number">111</span>)</span><br><span class="line">        <span class="comment">// 在jQuery中能阻止默认行为和冒泡</span></span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span></span><br><span class="line">      &#125;)</span><br><span class="line"></span><br><span class="line">      <span class="comment">// $(&#x27;form&#x27;).on(&#x27;submit&#x27;,function(e)&#123;</span></span><br><span class="line">      <span class="comment">//   e.preventDefault()</span></span><br><span class="line">      <span class="comment">//   console.log(222)</span></span><br><span class="line">      <span class="comment">// &#125;)</span></span><br><span class="line">    &#125;)</span><br></pre></td></tr></table></figure>

<p><img src="E:\能放\前端\截图\Ajax\jQuery监听表单.png" alt="jQuery监听表单"></p>
<h5 id="5-1-6阻止表单默认提交行为"><a href="#5-1-6阻止表单默认提交行为" class="headerlink" title="5.1.6阻止表单默认提交行为"></a>5.1.6阻止表单默认提交行为</h5><p>当监听到表单的提交事件以后，可以调用事件对象的 <code>event.preventDefault()</code> 函数，来阻止表单的提交和页面的跳转</p>
<p><img src="E:\能放\前端\截图\Ajax\阻止默认行为.png" alt="阻止默认行为"></p>
<h5 id="5-1-7serialize-函数"><a href="#5-1-7serialize-函数" class="headerlink" title="5.1.7serialize() 函数"></a>5.1.7<code>serialize()</code> 函数</h5><p><code>serialize()</code> 函数能够快速获取表单</p>
<p><strong>注意：</strong>在使用 serialize() 函数快速获取表单数据时，<strong>必须为每个表单元素添加 name 属性</strong></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$(<span class="string">&#x27;form&#x27;</span>).<span class="title function_">serialize</span>()</span><br></pre></td></tr></table></figure>

<h3 id="6-模板引擎"><a href="#6-模板引擎" class="headerlink" title="6-模板引擎"></a>6-模板引擎</h3><p><strong>模板引擎</strong>，它可以根据程序员指定的 <strong>模板结构</strong> 和 <strong>数据</strong>，自动生成一个完整的HTML页面</p>
<p>好处</p>
<ul>
<li>减少了字符串的拼接操作</li>
<li>使代码结构更清晰</li>
<li>使代码更易于阅读与维护</li>
</ul>
<p><img src="E:\能放\前端\截图\Ajax\模板引擎.png" alt="模板引擎"></p>
<h4 id="6-1art-template模板引擎"><a href="#6-1art-template模板引擎" class="headerlink" title="6.1art-template模板引擎"></a>6.1art-template模板引擎</h4><ul>
<li><p>导入 <code>art-template</code></p>
<p>在window全局，就多了一个函数，叫做 template(‘模板id’，需要渲染的数据对象)</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;script src=<span class="string">&quot;./lib/template-web.js&quot;</span>&gt;&lt;/script&gt;</span><br></pre></td></tr></table></figure></li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line">&lt;script type=<span class="string">&quot;text/html&quot;</span> id=<span class="string">&quot;t1&quot;</span>&gt;</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      姓名：&#123;&#123;name&#125;&#125;-年龄：&#123;&#123;age&#125;&#125;-</span></span><br><span class="line"><span class="language-xml">      a是&#123;&#123;data.a&#125;&#125;-b是&#123;&#123;data.b&#125;&#125;-</span></span><br><span class="line"><span class="language-xml">      a+b=&#123;&#123;data.a+data.b&#125;&#125;-</span></span><br><span class="line"><span class="language-xml">      您的性别为：&#123;&#123;sex === 0 ? &#x27;男&#x27; : &#x27;女&#x27;&#125;&#125;-</span></span><br><span class="line"><span class="language-xml">      strong标签&#123;&#123;@strong&#125;&#125;</span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">    &#123;&#123;<span class="keyword">if</span> ifLogin === <span class="literal">true</span>&#125;&#125;</span><br><span class="line">    欢迎&#123;&#123;name&#125;&#125;</span><br><span class="line">    &#123;&#123;<span class="keyword">else</span>&#125;&#125;</span><br><span class="line">    请登录</span><br><span class="line">    &#123;&#123;/<span class="keyword">if</span>&#125;&#125;</span><br><span class="line"></span><br><span class="line">    &#123;&#123;<span class="keyword">if</span> isLogin === <span class="literal">true</span>&#125;&#125;</span><br><span class="line">    欢迎&#123;&#123;name&#125;&#125;</span><br><span class="line">    &#123;&#123;/<span class="keyword">if</span>&#125;&#125;</span><br><span class="line">    -----------------------------------------</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">ul</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      &#123;&#123;each arr&#125;&#125;</span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">li</span>&gt;</span>&#123;&#123;$value&#125;&#125;<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      &#123;&#123;/each&#125;&#125;</span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span></span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">ul</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      &#123;&#123;each arr&#125;&#125;</span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">li</span>&gt;</span>&#123;&#123;$index&#125;&#125;<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      &#123;&#123;/each&#125;&#125;</span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span></span><br><span class="line">    </span><br><span class="line">  &lt;/script&gt;</span><br><span class="line">  <span class="language-xml"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="keyword">const</span> obj = &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="attr">name</span>: <span class="string">&#x27;xm&#x27;</span>,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="attr">age</span>: <span class="number">18</span>,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="attr">sex</span>: <span class="number">0</span>,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="attr">data</span>: &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        <span class="attr">a</span>: <span class="number">1</span>,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        <span class="attr">b</span>: <span class="number">2</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      &#125;,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="attr">arr</span>: [<span class="string">&#x27;张三&#x27;</span>, <span class="string">&#x27;李四&#x27;</span>, <span class="string">&#x27;王五&#x27;</span>],</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="attr">isLogin</span>: <span class="literal">true</span>,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="attr">strong</span>: <span class="string">&#x27;&lt;strong&gt;我是strong标签&lt;/strong&gt;&#x27;</span>,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    &#125;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="keyword">let</span> html = <span class="title function_">template</span>(<span class="string">&#x27;t1&#x27;</span>, obj)</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    $(<span class="string">&#x27;.main&#x27;</span>).<span class="title function_">html</span>(html)</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  </span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br></pre></td></tr></table></figure>

<h4 id="6-3过滤器"><a href="#6-3过滤器" class="headerlink" title="6.3过滤器"></a>6.3过滤器</h4><p>过滤器本质就是一个 <code>function</code> 函数</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;&#123;$value.<span class="property">money</span> | fn&#125;&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">template.<span class="property">defaults</span>.<span class="property">imports</span>.<span class="property">fn</span> = <span class="keyword">function</span> (<span class="params"> </span>) &#123; &#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">&lt;script type=<span class="string">&quot;text/html&quot;</span> id=<span class="string">&quot;t1&quot;</span>&gt;</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">ul</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      &#123;&#123;each arr&#125;&#125;</span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">li</span>&gt;</span>我的手机是：&#123;&#123;$value.name&#125;&#125;，价格是：&#123;&#123;$value.money | fn&#125;&#125;<span class="tag">&lt;/<span class="name">li</span>&gt;</span>    </span></span><br><span class="line"><span class="language-xml">      &#123;&#123;/each&#125;&#125;</span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span></span><br><span class="line">  &lt;/script&gt;</span><br><span class="line">  <span class="language-xml"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    template.<span class="property">defaults</span>.<span class="property">imports</span>.<span class="property">fn</span> = <span class="keyword">function</span> (<span class="params">money</span>) &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="keyword">return</span> money.<span class="title function_">toFixed</span>(<span class="number">2</span>) + <span class="string">&#x27;￥&#x27;</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    &#125;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="keyword">const</span> obj = &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="attr">arr</span>: [&#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        <span class="attr">name</span>: <span class="string">&#x27;p20&#x27;</span>,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        <span class="attr">money</span>: <span class="number">1999</span>,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      &#125;, &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        <span class="attr">name</span>: <span class="string">&#x27;p30&#x27;</span>,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        <span class="attr">money</span>: <span class="number">2999</span>,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      &#125;, &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        <span class="attr">name</span>: <span class="string">&#x27;p40&#x27;</span>,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        <span class="attr">money</span>: <span class="number">3999</span>,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      &#125;, &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        <span class="attr">name</span>: <span class="string">&#x27;p50&#x27;</span>,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        <span class="attr">money</span>: <span class="number">4999</span>,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      &#125;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      ]</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    &#125;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="keyword">let</span> html = <span class="title function_">template</span>(<span class="string">&#x27;t1&#x27;</span>, obj)</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    $(<span class="string">&#x27;.main&#x27;</span>).<span class="title function_">html</span>(html)</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  </span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br></pre></td></tr></table></figure>

<h4 id="6-4模板引擎的实现原理"><a href="#6-4模板引擎的实现原理" class="headerlink" title="6.4模板引擎的实现原理"></a>6.4模板引擎的实现原理</h4><p>正则与字符串操作</p>
<h5 id="6-4-1exec函数"><a href="#6-4-1exec函数" class="headerlink" title="6.4.1exec函数"></a>6.4.1exec函数</h5><p><code>exec()</code> 函数用于 <strong>检索字符串</strong> 中的正在表达式的匹配</p>
<p>如果字符串中又匹配的值，<strong>则返回该匹配值</strong>，否则返回 <strong>null</strong></p>
<h5 id="6-4-2分组"><a href="#6-4-2分组" class="headerlink" title="6.4.2分组"></a>6.4.2分组</h5><p>正则表达式中 （） 包起来的内容表示一个分组，可以通过分组来 <strong>提取自己想要的内容</strong>，示例代码如下</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> str = <span class="string">&#x27;&lt;div&gt;我是&#123;&#123;name&#125;&#125;&lt;/div&gt;&#x27;</span></span><br><span class="line"><span class="keyword">let</span> pattern = <span class="regexp">/&#123;&#123;([a-zA-Z]+)&#125;&#125;/</span></span><br><span class="line"><span class="keyword">let</span> patternResult = pattern.<span class="title function_">exec</span>(str)</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(patternResult)</span><br><span class="line"><span class="comment">//得到 name 相关的分组信息</span></span><br><span class="line"><span class="comment">//[&quot;&#123;&#123;name&#125;&#125;&quot;,&quot;name&quot;,index: 7, input: &quot;&lt;div&gt;我是&#123;&#123;name&#125;&#125;&lt;/div&gt;&quot;, groups: undefined]</span></span><br></pre></td></tr></table></figure>

<h5 id="6-4-3字符串的-replace-函数"><a href="#6-4-3字符串的-replace-函数" class="headerlink" title="6.4.3字符串的 replace 函数"></a>6.4.3字符串的 replace 函数</h5><p>replace() 函数用于在字符串中 用一些字符 替换 另一些字符的</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> result = <span class="string">&#x27;123456&#x27;</span>.<span class="title function_">replace</span>(<span class="string">&#x27;123&#x27;</span>,<span class="string">&#x27;abc&#x27;</span>)  <span class="comment">// &#x27;abc456&#x27;</span></span><br></pre></td></tr></table></figure>



<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// exec 提取出字符串中内容，每次匹配第一项，但是如果不存在正在匹配的内容 null</span></span><br><span class="line">       <span class="comment">// 场景：获取一个数据匹配的正则条件的内容</span></span><br><span class="line">       <span class="comment">// 数组结果 = 正则表达式.exec(被匹配的字符串)</span></span><br><span class="line">       <span class="comment">// test 检测字符串是否包含</span></span><br><span class="line">       <span class="comment">// 场景：判断一个数据是否满足正则条件</span></span><br><span class="line">       <span class="comment">// 布尔值结果 = 正则表达式.test(被匹配的字符串)</span></span><br><span class="line"></span><br><span class="line">       <span class="comment">// ? 0||1</span></span><br><span class="line">       <span class="comment">// + &gt;=1</span></span><br><span class="line">       <span class="comment">// * &gt;=0</span></span><br><span class="line">       <span class="keyword">let</span> reg = <span class="regexp">/\d+/</span>;</span><br><span class="line">       <span class="keyword">let</span> str = <span class="string">&#x27;abcaaabc&#x27;</span>;</span><br><span class="line">       <span class="variable language_">console</span>.<span class="title function_">log</span>(reg.<span class="title function_">exec</span>(str));</span><br><span class="line">       <span class="variable language_">console</span>.<span class="title function_">log</span>([<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>]);</span><br><span class="line"></span><br><span class="line">       <span class="comment">// 目标：模拟模板引擎的template.js 完成核心、简单的替换</span></span><br><span class="line">       <span class="comment">// 把模板中的 &#123;&#123;name&#125;&#125; 替换城真正的数据   yj</span></span><br><span class="line">       <span class="comment">// data = &#123;</span></span><br><span class="line">       <span class="comment">//     name:yj</span></span><br><span class="line">       <span class="comment">// &#125;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;</span><br><span class="line">        <span class="keyword">const</span> template = <span class="keyword">function</span>(<span class="params">id,data</span>)&#123;</span><br><span class="line">            <span class="keyword">let</span> html = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;#&#x27;</span>+id).<span class="property">innerHTML</span>;</span><br><span class="line">            <span class="comment">// console.log(&#x27;temp: &#x27;, temp);</span></span><br><span class="line">            <span class="comment">// 把下面字符串</span></span><br><span class="line">            <span class="comment">// temp = &lt;div&gt;我的名字叫&#123;&#123;name&#125;&#125;，我今年&#123;&#123;age&#125;&#125;岁，我是&#123;&#123;sex&#125;&#125;生&lt;/div&gt;</span></span><br><span class="line">            <span class="comment">// 变成另一个字符串</span></span><br><span class="line">            <span class="comment">// res = 我的名字叫yj，我今年18岁，我是男生</span></span><br><span class="line">            <span class="comment">// console.log(data);</span></span><br><span class="line">            <span class="comment">// data[&#x27;name&#x27;] === yj</span></span><br><span class="line">            <span class="keyword">let</span> reg = <span class="regexp">/&#123;&#123;([0-9a-zA-Z]+)&#125;&#125;/</span>;</span><br><span class="line">            <span class="comment">// exec 如果正则表达式在中间存在() 可以单独的被匹配出来</span></span><br><span class="line">            <span class="comment">// res=reg.exec(temp)</span></span><br><span class="line">            <span class="comment">// console.log(&#x27;res: &#x27;, res);</span></span><br><span class="line">            <span class="comment">// let html = temp.replace(res[0],data[res[1]])</span></span><br><span class="line">            <span class="comment">// console.log(&#x27;html: &#x27;, html);</span></span><br><span class="line">            <span class="comment">// res=reg.exec(html)</span></span><br><span class="line">            <span class="comment">// html = html.replace(res[0],data[res[1]])</span></span><br><span class="line">            <span class="comment">// console.log(&#x27;html: &#x27;, html);</span></span><br><span class="line">            <span class="comment">// res=reg.exec(html)</span></span><br><span class="line">            <span class="comment">// html = html.replace(res[0],data[res[1]])</span></span><br><span class="line">            <span class="comment">// console.log(&#x27;html: &#x27;, html);</span></span><br><span class="line">            <span class="comment">// let res = temp.replace(&#x27;&#123;&#123;name&#125;&#125;&#x27;,&#x27;yj&#x27;)</span></span><br><span class="line">            <span class="comment">// console.log(&#x27;res: &#x27;, res);</span></span><br><span class="line">            <span class="comment">// res = res.replace(&#x27;&#123;&#123;age&#125;&#125;&#x27;,&#x27;18&#x27;)</span></span><br><span class="line">            <span class="comment">// console.log(&#x27;res: &#x27;, res);</span></span><br><span class="line">            <span class="comment">// res = res.replace(&#x27;&#123;&#123;sex&#125;&#125;&#x27;,&#x27;男&#x27;)</span></span><br><span class="line">            <span class="comment">// console.log(&#x27;res: &#x27;, res);</span></span><br><span class="line">            <span class="keyword">while</span>(res=reg.<span class="title function_">exec</span>(html))&#123;</span><br><span class="line">                <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;res: &#x27;</span>, res);</span><br><span class="line">                html = html.<span class="title function_">replace</span>(res[<span class="number">0</span>],data[res[<span class="number">1</span>]])</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;html: &#x27;</span>, html);</span><br><span class="line">            <span class="keyword">return</span> html</span><br><span class="line">        &#125;</span><br><span class="line">    &lt;/script&gt;</span><br></pre></td></tr></table></figure>

<h3 id="7-XMLHttpRequest的基本使用"><a href="#7-XMLHttpRequest的基本使用" class="headerlink" title="7-XMLHttpRequest的基本使用"></a><code>7-XMLHttpRequest</code>的基本使用</h3><p><code>XMLHttpRequest</code>（简称 <code>xhr</code>）是浏览器提供的 <code>Javascript</code> 对象，通过它，可以<strong>请求服务器上的数据资源</strong>。之</p>
<p>前所学的 <code>jQuery</code> 中的 Ajax 函数，就是基于 <code>xhr</code> 对象封装出来的</p>
<h4 id="7-1使用xhr发起GET请求"><a href="#7-1使用xhr发起GET请求" class="headerlink" title="7.1使用xhr发起GET请求"></a>7.1使用<code>xhr</code>发起GET请求</h4><p><strong>步骤</strong></p>
<ul>
<li>创建 <code>xhr</code> 对象</li>
<li>调用 <code>xhr.open()</code> 函数</li>
<li>调用 <code>xhr.send()</code> 函数</li>
<li>监听 <code>xhr.onreadystatechange</code> 事件</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 1. 创建 XHR 对象</span></span><br><span class="line"><span class="keyword">var</span> xhr = <span class="keyword">new</span> <span class="title class_">XMLHttpRequest</span>()</span><br><span class="line"><span class="comment">// 2. 调用 open 函数</span></span><br><span class="line">xhr.<span class="title function_">open</span>(<span class="string">&#x27;GET&#x27;</span>, <span class="string">&#x27;http://www.liulongbin.top:3006/api/getbooks&#x27;</span>)</span><br><span class="line"><span class="comment">// 3. 调用 send 函数</span></span><br><span class="line">xhr.<span class="title function_">send</span>()</span><br><span class="line"><span class="comment">// 4. 监听 onreadystatechange 事件</span></span><br><span class="line">xhr.<span class="property">onreadystatechange</span> = <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">if</span> (xhr.<span class="property">readyState</span> === <span class="number">4</span> &amp;&amp; xhr.<span class="property">status</span> === <span class="number">200</span>) &#123;</span><br><span class="line">     <span class="comment">// 获取服务器响应的数据</span></span><br><span class="line">     <span class="variable language_">console</span>.<span class="title function_">log</span>(xhr.<span class="property">responseText</span>)</span><br><span class="line">   &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><code>XMLHttpRequest</code> 对象的 <code>readyState</code> 属性，用来表示<strong>当前 <code>Ajax</code> 请求所处的状态</strong>。每个 <code>Ajax</code> 请求必然处于以</p>
<p>下状态中的一个：</p>
<p><img src="E:\能放\前端\截图\Ajax\xhr属性.png" alt="xhr属性"></p>
<h4 id="7-2使用xhr发起带参数的GET请求"><a href="#7-2使用xhr发起带参数的GET请求" class="headerlink" title="7.2使用xhr发起带参数的GET请求"></a>7.2使用<code>xhr</code>发起带参数的GET请求</h4><p>使用 <code>xhr</code> 对象发起带参数的 <code>GET</code> 请求时，只需在调用 <code>xhr.open</code> 期间，为 <code>URL</code> 地址指定参数即可：</p>
<h4 id="查询字符串"><a href="#查询字符串" class="headerlink" title="查询字符串"></a>查询字符串</h4><p><strong>定义：</strong>查询字符串（URL 参数）是指在 URL 的末尾加上用于向服务器发送信息的字符串（变量）。</p>
<p><strong>格式：</strong>将英文的 <strong>?</strong> 放在<code>URL</code> 的末尾，然后再加上 <strong>参数＝值</strong> ，想加上多个参数的话，使用 <strong>&amp;</strong> 符号进行分隔。以</p>
<p>这个形式，可以将想要发送给服务器的数据添加到 <code>URL</code> 中。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// get 不带参数</span></span><br><span class="line">   &#123;</span><br><span class="line">     <span class="keyword">let</span> xhr = <span class="keyword">new</span> <span class="title class_">XMLHttpRequest</span>()</span><br><span class="line">     xhr.<span class="title function_">open</span>(<span class="string">&#x27;get&#x27;</span>,<span class="string">&#x27;http://ajax-base-api-t.itheima.net/api/getbooks&#x27;</span>)</span><br><span class="line">     xhr.<span class="title function_">send</span>()</span><br><span class="line">     xhr.<span class="property">onreadystatechange</span> = <span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">       <span class="keyword">if</span>(xhr.<span class="property">readyState</span> === <span class="number">4</span> &amp;&amp; xhr.<span class="property">status</span> === <span class="number">200</span>)&#123;</span><br><span class="line">         <span class="variable language_">console</span>.<span class="title function_">log</span>(xhr.<span class="property">response</span>)</span><br><span class="line">       &#125;</span><br><span class="line">     &#125;</span><br><span class="line">   &#125;</span><br><span class="line">   <span class="comment">// get 带参数</span></span><br><span class="line">   &#123;</span><br><span class="line">     <span class="keyword">let</span> xhr = <span class="keyword">new</span> <span class="title class_">XMLHttpRequest</span>()</span><br><span class="line">     xhr.<span class="title function_">open</span>(<span class="string">&#x27;get&#x27;</span>,<span class="string">&#x27;http://ajax-base-api-t.itheima.net/api/getbooks?id=3&#x27;</span>)</span><br><span class="line">     xhr.<span class="title function_">send</span>()</span><br><span class="line">     xhr.<span class="property">onreadystatechange</span> = <span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">       <span class="keyword">if</span>(xhr.<span class="property">readyState</span> === <span class="number">4</span> &amp;&amp; xhr.<span class="property">status</span> === <span class="number">200</span>)&#123;</span><br><span class="line">         <span class="variable language_">console</span>.<span class="title function_">log</span>(xhr.<span class="property">response</span>)</span><br><span class="line">       &#125;</span><br><span class="line">     &#125;</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure>

<h4 id="GET请求携带参数的本质"><a href="#GET请求携带参数的本质" class="headerlink" title="GET请求携带参数的本质"></a>GET请求携带参数的本质</h4><p>无论使用 <code>$.ajax()</code>，还是使用 <code>$.get()</code>，又或者直接使用 <code>xhr</code> 对象发起 <code>GET</code> 请求，当需要携带参数的时候，本质上，都是直接将参数以查询字符串的形式，追加到 URL 地址的后面，发送到服务器的。</p>
<p><img src="E:\能放\前端\截图\Ajax\get请求携带参数的本质.png" alt="get请求携带参数的本质"></p>
<h4 id="7-3-URL编码与解码"><a href="#7-3-URL编码与解码" class="headerlink" title="7.3-URL编码与解码"></a>7.3-URL编码与解码</h4><p><code>URL</code> 地址中，只允许出现英文相关的字母、标点符号、数字，因此，在 <code>URL</code> 地址中不允许出现中文字符。</p>
<p>如果 URL 中需要包含中文这样的字符，则必须对中文字符进行<strong>编码</strong>（转义）。</p>
<p><strong>URL编码的原则</strong>：使用安全的字符（没有特殊用途或者特殊意义的可打印字符）去表示那些不安全的字符。</p>
<p>URL编码原则的通俗理解：使用英文字符去表示非英文字符</p>
<p>浏览器提供了 <code>URL</code> 编码与解码的 <code>API</code>，分别是：</p>
<ul>
<li><code>encodeURI()</code> 编码的函数</li>
<li><code>decodeURI()</code> 解码的函数</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;</span><br><span class="line">    <span class="keyword">let</span> xyj = <span class="string">&#x27;西游记&#x27;</span></span><br><span class="line">    <span class="comment">// 编码</span></span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="built_in">encodeURI</span>(xyj))</span><br><span class="line">    <span class="comment">// 解码</span></span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="built_in">decodeURI</span>(<span class="string">&#x27;%E8%A5%BF%E6%B8%B8%E8%AE%B0&#x27;</span>))</span><br></pre></td></tr></table></figure>

<h4 id="7-4使用xhr发起POST请求"><a href="#7-4使用xhr发起POST请求" class="headerlink" title="7.4使用xhr发起POST请求"></a>7.4使用<code>xhr</code>发起<code>POST</code>请求</h4><p><strong>步骤</strong></p>
<ul>
<li>创建 <code>xhr</code> 对象</li>
<li>调用 <code>xhr.open()</code> 函数</li>
<li><strong>设置 Content-Type 属性</strong>（固定写法）</li>
<li>调用 <code>xhr.send()</code> 函数，<strong>同时指定要发送的数据</strong></li>
<li>监听 <code>xhr.onreadystatechange</code> 事件</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 1. 创建 xhr 对象</span></span><br><span class="line"><span class="keyword">var</span> xhr = <span class="keyword">new</span> <span class="title class_">XMLHttpRequest</span>()</span><br><span class="line"><span class="comment">// 2. 调用 open 函数</span></span><br><span class="line">xhr.<span class="title function_">open</span>(<span class="string">&#x27;POST&#x27;</span>, <span class="string">&#x27;http://www.liulongbin.top:3006/api/addbook&#x27;</span>)</span><br><span class="line"><span class="comment">// 3. 设置 Content-Type 属性（固定写法）</span></span><br><span class="line">xhr.<span class="title function_">setRequestHeader</span>(<span class="string">&#x27;Content-Type&#x27;</span>, <span class="string">&#x27;application/x-www-form-urlencoded&#x27;</span>)</span><br><span class="line"><span class="comment">// 4. 调用 send 函数</span></span><br><span class="line">xhr.<span class="title function_">send</span>(<span class="string">&#x27;bookname=水浒传&amp;author=施耐庵&amp;publisher=上海图书出版社&#x27;</span>)</span><br><span class="line"><span class="comment">// 5. 监听事件</span></span><br><span class="line">xhr.<span class="property">onreadystatechange</span> = <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">if</span> (xhr.<span class="property">readyState</span> === <span class="number">4</span> &amp;&amp; xhr.<span class="property">status</span> === <span class="number">200</span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(xhr.<span class="property">responseText</span>)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="8-JSON"><a href="#8-JSON" class="headerlink" title="8-JSON"></a>8-JSON</h3><p>念：**<code>JSON</code> 的英文全称是 <code>JavaScript Object Notation</code>，即“<strong>JavaScript 对象表示法</strong>”。简单来讲，JSON<code>就是</code>Javascript<code>对象和数组的字符串表示法，它使用文本表示一个</code>JS&#96; 对象或数组的信息，因此，</p>
<p><strong><code>JSON</code> 的本质是字符串</strong>。</p>
<p><strong>作用：</strong><code>JSON</code> 是一种轻量级的文本数据交换格式，在作用上类似于 <code>XML</code>，专门用于存储和传输数据，但是 <code>JSON</code> 比 <code>XML</code> 更小、更快、更易解析。</p>
<p><strong>现状：</strong><code>JSON</code> 是在 2001 年开始被推广和使用的数据格式，到现今为止，<code>JSON</code> 已经成为了主流的数据交换格式</p>
<h4 id="8-1JSON的两种结构"><a href="#8-1JSON的两种结构" class="headerlink" title="8.1JSON的两种结构"></a>8.1<code>JSON</code>的两种结构</h4><p><code>JSON</code> 就是用字符串来表示 <code>Javascript</code> 的对象和数组。所以，<code>JSON</code> 中包含<strong>对象</strong>和<strong>数组</strong>两种结构，通过这</p>
<p>两种结构的相互嵌套，可以表示各种复杂的数据结构。</p>
<h5 id="8-1-1对象结构"><a href="#8-1-1对象结构" class="headerlink" title="8.1.1对象结构"></a>8.1.1<strong>对象结构</strong></h5><p>对象结构在 <code>JSON</code> 中表示为 <code>&#123; &#125;</code> 括起来的内容。数据结构为 <code>&#123; key: value, key: value, … &#125;</code> 的键</p>
<p>值对结构。其中，<code>key</code> 必须是使用英文的双引号包裹的字符串，<code>value</code> 的数据类型可以是<strong>数字、字符串、</strong></p>
<p><strong>布尔值、null、数组、对象</strong>6种类型。</p>
<h5 id="8-1-2数组结构"><a href="#8-1-2数组结构" class="headerlink" title="8.1.2数组结构"></a>8.1.2<strong>数组结构</strong></h5><p>数组结构在 <code>JSON</code> 中表示为 <code>[ ]</code> 括起来的内容。数据结构为 <code>[ &quot;java&quot;, &quot;javascript&quot;, 30, true … ]</code> 。</p>
<p>数组中数据的类型可以是<strong>数字、字符串、布尔值、null、数组、对象</strong>6种类型。</p>
<h4 id="8-2JSON语法注意事项"><a href="#8-2JSON语法注意事项" class="headerlink" title="8.2JSON语法注意事项"></a>8.2<code>JSON</code>语法注意事项</h4><p>① 属性名必须使用双引号包裹</p>
<p>② 字符串类型的值必须使用双引号包裹</p>
<p>③ <code>JSON</code> 中不允许使用单引号表示字符串</p>
<p>④ <code>JSON</code> 中不能写注释</p>
<p>⑤ <code>JSON</code> 的最外层必须是对象或数组格式</p>
<p>⑥ 不能使用 <code>undefined</code> 或函数作为 <code>JSON</code> 的值</p>
<p><strong><code>JSON</code> 的作用：</strong>在计算机与网络之间存储和传输数据。</p>
<p><strong><code>JSON</code> 的本质：</strong>用字符串来表示 <code>Javascript</code> 对象数据或数组数据</p>
<h4 id="8-3JSON和JS对象的关系"><a href="#8-3JSON和JS对象的关系" class="headerlink" title="8.3JSON和JS对象的关系"></a>8.3<code>JSON</code>和<code>JS</code>对象的关系</h4><p><code>JSON</code> 是 <code>JS</code> 对象的字符串表示法，它使用文本表示一个 <code>JS</code> 对象的信息，本质是一个字符串。例如：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//这是一个对象</span></span><br><span class="line"><span class="keyword">const</span> obj = &#123;<span class="attr">a</span>: <span class="string">&#x27;Hello&#x27;</span>, <span class="attr">b</span>: <span class="string">&#x27;world&#x27;</span>&#125;</span><br><span class="line"><span class="comment">//这是一个JSON字符串，本质就是一个字符串</span></span><br><span class="line"><span class="keyword">const</span> json = <span class="string">&#x27;&#123;&quot;a&quot;: &quot;Hello&quot;, &quot;b&quot;: &quot;World&quot;&#125;&#x27;</span></span><br></pre></td></tr></table></figure>

<h4 id="8-4JSON和JS对象的互转"><a href="#8-4JSON和JS对象的互转" class="headerlink" title="8.4JSON和JS对象的互转"></a>8.4<code>JSON</code>和<code>JS</code>对象的互转</h4><p>要实现从 <code>JSON</code> 字符串转换为 <code>JS</code> 对象，使用 <code>JSON.parse()</code> 方法：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 实现从JSON字符串转换为JS对象，使用JSON.parse()方法</span></span><br><span class="line">    <span class="keyword">const</span> jsonStr = <span class="string">&#x27;&#123;&quot;a&quot;:&quot;Hello&quot;,&quot;b&quot;:&quot;world&quot;&#125;&#x27;</span></span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title class_">JSON</span>.<span class="title function_">parse</span>(jsonStr))</span><br></pre></td></tr></table></figure>

<p>要实现从 <code>JS</code> 对象转换为 <code>JSON</code> 字符串，使用 <code>JSON.stringify()</code> 方法：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 实现从JS对象转换为JSON字符串，使用JSON.stringify()方法</span></span><br><span class="line">    <span class="keyword">const</span> json = <span class="title class_">JSON</span>.<span class="title function_">stringify</span>(&#123;<span class="attr">a</span>:<span class="string">&#x27;hello&#x27;</span>,<span class="attr">b</span>:<span class="string">&#x27;world&#x27;</span>&#125;)</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(json)</span><br></pre></td></tr></table></figure>

<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> myjson = &#123;</span><br><span class="line">      <span class="string">&quot;name&quot;</span> : <span class="string">&quot;张三&quot;</span>,</span><br><span class="line">      <span class="string">&quot;age&quot;</span> : <span class="number">18</span>,</span><br><span class="line">      <span class="string">&quot;arr&quot;</span> : [<span class="string">&quot;a&quot;</span>,<span class="string">&quot;b&quot;</span>]</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 对象变成JSON字符串</span></span><br><span class="line">    <span class="keyword">let</span> json = <span class="title class_">JSON</span>.<span class="title function_">stringify</span>(myjson)</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(json)</span><br><span class="line">    <span class="comment">// json字符串变成对象</span></span><br><span class="line">    <span class="keyword">let</span> obj = <span class="title class_">JSON</span>.<span class="title function_">parse</span>(json)</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(obj)</span><br></pre></td></tr></table></figure>

<p>应用场景</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> xhr = <span class="keyword">new</span> <span class="title class_">XMLHttpRequest</span>()</span><br><span class="line">xhr.<span class="title function_">open</span>(<span class="string">&#x27;GET&#x27;</span>, <span class="string">&#x27;http://www.liulongbin.top:3006/api/getbooks&#x27;</span>)</span><br><span class="line">xhr.<span class="title function_">send</span>()</span><br><span class="line">xhr.<span class="property">onreadystatechange</span> = <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">if</span> (xhr.<span class="property">readyState</span> === <span class="number">4</span> &amp;&amp; xhr.<span class="property">status</span> === <span class="number">200</span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(xhr.<span class="property">responseText</span>)</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="keyword">typeof</span> xhr.<span class="property">responseText</span>)</span><br><span class="line">    <span class="keyword">var</span> result = <span class="title class_">JSON</span>.<span class="title function_">parse</span>(xhr.<span class="property">responseText</span>)</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(result)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="8-5序列化和反序列化"><a href="#8-5序列化和反序列化" class="headerlink" title="8.5序列化和反序列化"></a>8.5序列化和反序列化</h4><p>把<strong>数据对象</strong> <strong>转换为</strong> <strong>字符串</strong>的过程，叫做<strong>序列化</strong>，例如：调用 <code>JSON.stringify()</code> 函数的操作，叫做 <code>JSON</code> 序列化。</p>
<p>把<strong>字符串</strong> <strong>转换为</strong> <strong>数据对象</strong>的过程，叫做<strong>反序列化</strong>，例如：调用 <code>JSON.parse()</code> 函数的操作，叫做 <code>JSON</code> 反序列化。</p>
<h4 id="8-6封装自己的Ajax函数"><a href="#8-6封装自己的Ajax函数" class="headerlink" title="8.6封装自己的Ajax函数"></a>8.6封装自己的Ajax函数</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">myAjax</span>(<span class="params">options</span>) &#123;</span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">log</span>(options)</span><br><span class="line">      <span class="comment">// 准备数据</span></span><br><span class="line">      <span class="keyword">let</span> &#123; url, tyep, data, success &#125; = options</span><br><span class="line">      <span class="comment">// 转换type 为大写</span></span><br><span class="line">      type = tyep.<span class="title function_">toLocaleUpperCase</span>()</span><br><span class="line">      <span class="comment">// data 数据处理</span></span><br><span class="line">      <span class="keyword">let</span> arr = []</span><br><span class="line">      <span class="keyword">for</span> (<span class="keyword">let</span> key <span class="keyword">in</span> data) &#123;</span><br><span class="line">        arr.<span class="title function_">push</span>(key + <span class="string">&#x27;=&#x27;</span> + data[key])</span><br><span class="line">      &#125;</span><br><span class="line">      data = arr.<span class="title function_">join</span>(<span class="string">&#x27;&amp;&#x27;</span>)</span><br><span class="line">      <span class="comment">// 发起原生的请求 判断get和post</span></span><br><span class="line">      <span class="keyword">let</span> xhr = <span class="keyword">new</span> <span class="title class_">XMLHttpRequest</span>()</span><br><span class="line">      <span class="keyword">if</span> (tyep === <span class="string">&#x27;GET&#x27;</span>) &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;get请求&#x27;</span>)</span><br><span class="line">        xhr.<span class="title function_">open</span>(tyep, url + <span class="string">&#x27;?&#x27;</span> + data)</span><br><span class="line">        xhr.<span class="title function_">send</span>()</span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;post 请求&#x27;</span>)</span><br><span class="line">        xhr.<span class="title function_">open</span>(tyep, url)</span><br><span class="line">        xhr.<span class="title function_">setRequestHeader</span>(<span class="string">&#x27;Content-Type&#x27;</span>, <span class="string">&#x27;application/x-www-form-urlencoded&#x27;</span>)</span><br><span class="line">        xhr.<span class="title function_">send</span>(data)</span><br><span class="line">      &#125;</span><br><span class="line">      xhr.<span class="property">onreadystatechange</span> = <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (xhr.<span class="property">readyState</span> === <span class="number">4</span> &amp;&amp; xhr.<span class="property">status</span> === <span class="number">200</span>) &#123;</span><br><span class="line">          <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title class_">JSON</span>.<span class="title function_">parse</span>(xhr.<span class="property">response</span>))</span><br><span class="line">          <span class="comment">// 必须 存在 success 并且还是函数</span></span><br><span class="line">          <span class="keyword">typeof</span> success === <span class="string">&#x27;function&#x27;</span> &amp;&amp; <span class="title function_">success</span>(<span class="title class_">JSON</span>.<span class="title function_">parse</span>(xhr.<span class="property">response</span>))</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"> <span class="comment">// 调用</span></span><br><span class="line">    <span class="title function_">myAjax</span>(&#123;</span><br><span class="line">      <span class="attr">url</span>: <span class="string">&#x27;http://ajax-base-api-t.itheima.net/api/addbook&#x27;</span>,</span><br><span class="line">      <span class="attr">tyep</span>: <span class="string">&#x27;post&#x27;</span>,</span><br><span class="line">      <span class="attr">data</span>: &#123;</span><br><span class="line">        <span class="attr">bookname</span>: <span class="string">&#x27;西游记2&#x27;</span>,</span><br><span class="line">        <span class="attr">author</span>: <span class="string">&#x27;666&#x27;</span>,</span><br><span class="line">        <span class="attr">publisher</span>: <span class="string">&#x27;48期&#x27;</span></span><br><span class="line">      &#125;,</span><br><span class="line">      <span class="title function_">success</span>(<span class="params">res</span>) &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(res)</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;)</span><br></pre></td></tr></table></figure>

<h4 id="8-7设置HTTP请求时限"><a href="#8-7设置HTTP请求时限" class="headerlink" title="8.7设置HTTP请求时限"></a>8.7设置<code>HTTP</code>请求时限</h4><p>有时，<code>Ajax</code> 操作很耗时，而且无法预知要花多少时间。如果网速很慢，用户可能要等很久。新版本的 <code>XMLHttpRequest</code> 对象，增加了 <code>timeout</code> 属性，可以设置 <code>HTTP</code> 请求的时限：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;</span><br><span class="line">    <span class="keyword">let</span> xhr = <span class="keyword">new</span> <span class="title class_">XMLHttpRequest</span>()</span><br><span class="line">    <span class="comment">// 当前时间</span></span><br><span class="line">    <span class="keyword">let</span> starTime = +<span class="keyword">new</span> <span class="title class_">Date</span>()</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(starTime)</span><br><span class="line">    <span class="comment">// 超时限制</span></span><br><span class="line">    xhr.<span class="property">timeout</span> = <span class="number">52</span></span><br><span class="line">    xhr.<span class="title function_">open</span>(<span class="string">&#x27;get&#x27;</span>, <span class="string">&#x27;http://ajax-base-api-t.itheima.net/api/getbooks&#x27;</span>)</span><br><span class="line">    xhr.<span class="title function_">send</span>()</span><br><span class="line">    <span class="comment">// 超时判断</span></span><br><span class="line">    xhr.<span class="property">ontimeout</span> = <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;请求超时&#x27;</span>)</span><br><span class="line">    &#125;</span><br><span class="line">    xhr.<span class="property">onreadystatechange</span> = <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">      <span class="keyword">if</span> (xhr.<span class="property">readyState</span> === <span class="number">4</span> &amp;&amp; xhr.<span class="property">status</span> === <span class="number">200</span>) &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title class_">JSON</span>.<span class="title function_">parse</span>(xhr.<span class="property">response</span>))</span><br><span class="line">        <span class="comment">// 成功后当前时间</span></span><br><span class="line">        <span class="keyword">let</span> endTime = +<span class="keyword">new</span> <span class="title class_">Date</span>()</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(endTime)</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &lt;/script&gt;</span><br></pre></td></tr></table></figure>

<h4 id="8-8FormData对象管理表单数据"><a href="#8-8FormData对象管理表单数据" class="headerlink" title="8.8FormData对象管理表单数据"></a>8.8<code>FormData</code>对象管理表单数据</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">&lt;form action=<span class="string">&quot;&quot;</span>&gt;</span><br><span class="line">    &lt;input type=&quot;text&quot; name=&quot;uname&quot;&gt;</span><br><span class="line">    &lt;input type=&quot;text&quot; name=&quot;age&quot;&gt;</span><br><span class="line">    &lt;input type=&quot;text&quot; name=&quot;sex&quot;&gt;</span><br><span class="line">    &lt;button type=&quot;submit&quot;&gt;提交&lt;/button&gt;</span><br><span class="line">  &lt;/form&gt;</span><br><span class="line">  &lt;script&gt;</span><br><span class="line">    let btn = document.querySelector(&#x27;button&#x27;)</span><br><span class="line">    btn.onclick = function (e) &#123;</span><br><span class="line">      // 方法1</span><br><span class="line">      // let data = new FormData(document.querySelector(&#x27;form&#x27;))</span><br><span class="line">      // let xhr = new XMLHttpRequest()</span><br><span class="line">      // xhr.open(&#x27;post&#x27;, &#x27;http://ajax-base-api-t.itheima.net/api/formdata&#x27;)</span><br><span class="line">      // xhr.send()</span><br><span class="line">      // xhr.onreadystatechange = function () &#123;</span><br><span class="line">      //   if (xhr.readyState === 4 &amp;&amp; xhr.status === 200) &#123;</span><br><span class="line">      //     console.log(JSON.parse(xhr.response))</span><br><span class="line">      //   &#125;</span><br><span class="line">      // &#125;</span><br><span class="line"></span><br><span class="line">      // 方法2</span><br><span class="line">      let data2 = new FormData(document.querySelector(&#x27;form&#x27;))</span><br><span class="line">      data2.append(&#x27;id&#x27;, 1)</span><br><span class="line">      data2.append(&#x27;iphone&#x27;, 6666666)</span><br><span class="line">      data2.append(&#x27;wx&#x27;, 8888888)</span><br><span class="line">      let xhr2 = new XMLHttpRequest()</span><br><span class="line">      xhr2.open(&#x27;post&#x27;, &#x27;http://ajax-base-api-t.itheima.net/api/formdata&#x27;)</span><br><span class="line">      xhr2.send(data2)</span><br><span class="line">      xhr2.onreadystatechange = function () &#123;</span><br><span class="line">        if (xhr2.readyState === 4 &amp;&amp; xhr2.status === 200) &#123;</span><br><span class="line">          console.log(JSON.parse(xhr2.response))</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">      e.preventDefault()</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<h4 id="8-9上传文件"><a href="#8-9上传文件" class="headerlink" title="8.9上传文件"></a>8.9上传文件</h4><p>新版 <code>XMLHttpRequest</code> 对象，不仅可以发送文本信息，还可以上传文件。</p>
<p><strong>实现步骤：</strong></p>
<p>① 定义 <code>UI</code> 结构</p>
<p>② 验证是否选择了文件</p>
<p>③ 向 <code>FormData</code> 中追加文件</p>
<p>④ 使用 <code>xhr</code> 发起上传文件的请求</p>
<p>⑤ 监听 <code>onreadystatechange</code> 事件</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line">&lt;body&gt;</span><br><span class="line">  &lt;form&gt;</span><br><span class="line">    &lt;input type=&quot;file&quot; name=&quot;avatar&quot; id=&quot;file&quot;&gt;</span><br><span class="line">    &lt;input type=&quot;button&quot; value=&quot;上传&quot; id=&quot;btn&quot;&gt;</span><br><span class="line">    &lt;img src=&quot;&quot; alt=&quot;&quot;&gt;</span><br><span class="line">  &lt;/form&gt;</span><br><span class="line">  &lt;script&gt;</span><br><span class="line">    // 1.点击按钮</span><br><span class="line">    // 2.收集上传文件</span><br><span class="line">    // 3.发起请求</span><br><span class="line">    // 4.显示上传成功的图片</span><br><span class="line">    let btn = document.querySelector(&#x27;#btn&#x27;)</span><br><span class="line">    btn.onclick = function () &#123;</span><br><span class="line">      // console.log(1)</span><br><span class="line">      // 获取方法1</span><br><span class="line">      let data = new FormData(document.querySelector(&#x27;form&#x27;))</span><br><span class="line"></span><br><span class="line">      // console.log(data)</span><br><span class="line">      // let file = document.querySelector(&#x27;#file&#x27;)</span><br><span class="line">      // console.dir(file)</span><br><span class="line">      // 获取方法2</span><br><span class="line">      // let img = document.querySelector(&#x27;#file&#x27;).files[0]</span><br><span class="line">      // console.log(img)</span><br><span class="line">      // let data = new FormData()</span><br><span class="line">      // data.append(&#x27;avatar&#x27;, img)</span><br><span class="line"></span><br><span class="line">      let xhr = new XMLHttpRequest()</span><br><span class="line">      xhr.open(&#x27;post&#x27;, &#x27;http://ajax-base-api-t.itheima.net/api/upload/avatar&#x27;)</span><br><span class="line">      xhr.send(data)</span><br><span class="line">      xhr.onreadystatechange = function () &#123;</span><br><span class="line">        if (xhr.readyState === 4 &amp;&amp; xhr.status === 200) &#123;</span><br><span class="line">          let res = JSON.parse(xhr.response)</span><br><span class="line">          // console.log(JSON.parse(xhr.response))</span><br><span class="line">          console.log(res)</span><br><span class="line">          if (res.status !== 200) return alert(&#x27;网络异常&#x27;)</span><br><span class="line">          let myimg = document.querySelector(&#x27;img&#x27;)</span><br><span class="line">          myimg.src = &#x27;http://ajax-base-api-t.itheima.net&#x27; + res.url</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &lt;/script&gt;</span><br><span class="line">&lt;/body&gt;</span><br></pre></td></tr></table></figure>

<h4 id="8-10显示文件上传进度"><a href="#8-10显示文件上传进度" class="headerlink" title="8.10显示文件上传进度"></a>8.10显示文件上传进度</h4><p>计算文件上传进度</p>
<p>新版本的 <code>XMLHttpRequest</code> 对象中，可以通过监听 <code>xhr.upload.onprogress</code> 事件，来获取到文件的上传进度。语法格式如下：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 创建 XHR 对象</span></span><br><span class="line"><span class="keyword">var</span> xhr = <span class="keyword">new</span> <span class="title class_">XMLHttpRequest</span>()</span><br><span class="line"><span class="comment">// 监听 xhr.upload 的 onprogress 事件</span></span><br><span class="line">xhr.<span class="property">upload</span>.<span class="property">onprogress</span> = <span class="keyword">function</span>(<span class="params">e</span>) &#123;</span><br><span class="line">     <span class="comment">// e.lengthComputable 是一个布尔值，表示当前上传的资源是否具有可计算的长度</span></span><br><span class="line">     <span class="keyword">if</span> (e.<span class="property">lengthComputable</span>) &#123;</span><br><span class="line">         <span class="comment">// e.loaded 已传输的字节</span></span><br><span class="line">         <span class="comment">// e.total 需传输的总字节</span></span><br><span class="line">         <span class="keyword">var</span> percentComplete = <span class="title class_">Math</span>.<span class="title function_">ceil</span>((e.<span class="property">loaded</span> / e.<span class="property">total</span>) * <span class="number">100</span>)</span><br><span class="line">     &#125;</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure>

<p>导入需要的库</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">&quot;stylesheet&quot;</span> <span class="attr">href</span>=<span class="string">&quot;./lib/bootstrap.css&quot;</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;./lib/jquery.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>基于<code>Bootstrap</code>渲染进度条</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 进度条 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;progress&quot;</span> <span class="attr">style</span>=<span class="string">&quot;width: 500px; margin: 10px 0;&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;progress-bar progress-bar-info progress-barstriped active&quot;</span> <span class="attr">id</span>=<span class="string">&quot;percent&quot;</span> <span class="attr">style</span>=<span class="string">&quot;width: 0%&quot;</span>&gt;</span></span><br><span class="line">    0%</span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>动态设置到进度条上</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">xhr.<span class="property">upload</span>.<span class="property">onprogress</span> = <span class="keyword">function</span>(<span class="params">e</span>) &#123;</span><br><span class="line">     <span class="keyword">if</span> (e.<span class="property">lengthComputable</span>) &#123;</span><br><span class="line">         <span class="comment">// 1. 计算出当前上传进度的百分比</span></span><br><span class="line">         <span class="keyword">var</span> percentComplete = <span class="title class_">Math</span>.<span class="title function_">ceil</span>((e.<span class="property">loaded</span> / e.<span class="property">total</span>) * <span class="number">100</span>)</span><br><span class="line">         $(<span class="string">&#x27;#percent&#x27;</span>)</span><br><span class="line">         <span class="comment">// 2. 设置进度条的宽度</span></span><br><span class="line">         .<span class="title function_">attr</span>(<span class="string">&#x27;style&#x27;</span>, <span class="string">&#x27;width:&#x27;</span> + percentComplete + <span class="string">&#x27;%&#x27;</span>)</span><br><span class="line">         <span class="comment">// 3. 显示当前的上传进度百分比</span></span><br><span class="line">         .<span class="title function_">html</span>(percentComplete + <span class="string">&#x27;%&#x27;</span>)</span><br><span class="line">     &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>监听上传完成的事件</strong></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">xhr.<span class="property">upload</span>.<span class="property">onload</span> = <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">     $(<span class="string">&#x27;#percent&#x27;</span>)</span><br><span class="line">     <span class="comment">// 移除上传中的类样式</span></span><br><span class="line">     .<span class="title function_">removeClass</span>()</span><br><span class="line">     <span class="comment">// 添加上传完成的类样式</span></span><br><span class="line">     .<span class="title function_">addClass</span>(<span class="string">&#x27;progress-bar progress-bar-success&#x27;</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>加载圈</strong></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line">&lt;body&gt;</span><br><span class="line">  &lt;form action=&quot;&quot;&gt;</span><br><span class="line">    &lt;input type=&quot;file&quot; id=&quot;file&quot;&gt;</span><br><span class="line">    &lt;input type=&quot;button&quot; id=&quot;btn&quot; value=&quot;立即上传&quot;&gt;</span><br><span class="line">    &lt;img src=&quot;./loading.gif&quot; alt=&quot;&quot; style=&quot;display: none;&quot;&gt;</span><br><span class="line">    &lt;script src=&quot;./lib/jquery.js&quot;&gt;&lt;/script&gt;</span><br><span class="line">    &lt;script&gt;</span><br><span class="line">      $(function () &#123;</span><br><span class="line">        // 全局 .ajaxStart / .ajaxStop</span><br><span class="line">        $(document).ajaxStart(function () &#123;</span><br><span class="line">          $(&#x27;img&#x27;).show()</span><br><span class="line">        &#125;)</span><br><span class="line">        $(document).ajaxStop(function () &#123;</span><br><span class="line">          $(&#x27;img&#x27;).hide()</span><br><span class="line">        &#125;)</span><br><span class="line"></span><br><span class="line">        $(&#x27;#btn&#x27;).click(function () &#123;</span><br><span class="line">          let data = new FormData(document.querySelector(&#x27;form&#x27;))</span><br><span class="line">          $.ajax(&#123;</span><br><span class="line">            url: &#x27;http://ajax-base-api-t.itheima.net/api/upload/avatar&#x27;,</span><br><span class="line">            type: &#x27;post&#x27;,</span><br><span class="line">            data: data,</span><br><span class="line">            contentType: false,</span><br><span class="line">            processData: false,</span><br><span class="line">            // 局部 beforeSend()  / complete()</span><br><span class="line">            beforeSend() &#123;</span><br><span class="line">              console.log(&#x27;请求发起&#x27;);</span><br><span class="line">            &#125;,</span><br><span class="line">            complete() &#123;</span><br><span class="line">              console.log(&#x27;请求结束&#x27;);</span><br><span class="line">            &#125;,</span><br><span class="line">            success(res) &#123;</span><br><span class="line">              console.log(res)</span><br><span class="line">            &#125;</span><br><span class="line">          &#125;)</span><br><span class="line">        &#125;)</span><br><span class="line">      &#125;)</span><br><span class="line">    &lt;/script&gt;</span><br><span class="line">  &lt;/form&gt;</span><br><span class="line">&lt;/body&gt;</span><br></pre></td></tr></table></figure>

<h4 id="8-11axios"><a href="#8-11axios" class="headerlink" title="8.11axios"></a>8.11<code>axios</code></h4><p><code>Axios</code> 是专注于<strong>网络数据请求</strong>的库。</p>
<p>相比于原生的 <code>XMLHttpRequest</code> 对象，<code>axios</code> <strong>简单易用</strong>。</p>
<p>相比于 <code>jQuery</code>，<code>axios</code> 更加<strong>轻量化</strong>，只专注于网络数据请求。</p>
<h5 id="8-11-1axios发起GET请求"><a href="#8-11-1axios发起GET请求" class="headerlink" title="8.11.1axios发起GET请求"></a>8.11.1<code>axios</code>发起GET请求</h5><p><code>axios</code> 发起 <code>get</code> 请求的语法：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">axios.<span class="title function_">get</span>(<span class="string">&#x27;url&#x27;</span>, &#123; <span class="attr">params</span>: &#123; <span class="comment">/*参数*/</span> &#125; &#125;).<span class="title function_">then</span>(callback)</span><br></pre></td></tr></table></figure>

<p><strong>具体的请求示例如下：</strong></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 请求的 URL 地址</span></span><br><span class="line"><span class="keyword">var</span> url = <span class="string">&#x27;http://www.liulongbin.top:3006/api/get&#x27;</span></span><br><span class="line"><span class="comment">// 请求的参数对象</span></span><br><span class="line"><span class="keyword">var</span> paramsObj = &#123; <span class="attr">name</span>: <span class="string">&#x27;zs&#x27;</span>, <span class="attr">age</span>: <span class="number">20</span> &#125;</span><br><span class="line"><span class="comment">// 调用 axios.get() 发起 GET 请求</span></span><br><span class="line">axios.<span class="title function_">get</span>(url, &#123; <span class="attr">params</span>: paramsObj &#125;).<span class="title function_">then</span>(<span class="keyword">function</span>(<span class="params">res</span>) &#123;</span><br><span class="line">     <span class="comment">// res.data 是服务器返回的数据</span></span><br><span class="line">     <span class="keyword">var</span> result = res.<span class="property">data</span></span><br><span class="line">     <span class="variable language_">console</span>.<span class="title function_">log</span>(res)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<h5 id="8-11-2axios发起POST请求"><a href="#8-11-2axios发起POST请求" class="headerlink" title="8.11.2axios发起POST请求"></a>8.11.2<code>axios</code>发起<code>POST</code>请求</h5><p><code>axios</code> 发起 <code>post</code> 请求的语法：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">axios.<span class="title function_">post</span>(<span class="string">&#x27;url&#x27;</span>, &#123; <span class="comment">/*参数*/</span> &#125;).<span class="title function_">then</span>(callback)</span><br></pre></td></tr></table></figure>

<p><strong>具体的请求示例如下：</strong></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 请求的 URL 地址</span></span><br><span class="line"><span class="keyword">var</span> url = <span class="string">&#x27;http://www.liulongbin.top:3006/api/post&#x27;</span></span><br><span class="line"><span class="comment">// 要提交到服务器的数据</span></span><br><span class="line"><span class="keyword">var</span> dataObj = &#123; <span class="attr">location</span>: <span class="string">&#x27;北京&#x27;</span>, <span class="attr">address</span>: <span class="string">&#x27;顺义&#x27;</span> &#125;</span><br><span class="line"><span class="comment">// 调用 axios.post() 发起 POST 请求</span></span><br><span class="line">axios.<span class="title function_">post</span>(url, dataObj).<span class="title function_">then</span>(<span class="keyword">function</span>(<span class="params">res</span>) &#123;</span><br><span class="line">     <span class="comment">// res.data 是服务器返回的数据</span></span><br><span class="line">     <span class="keyword">var</span> result = res.<span class="property">data</span></span><br><span class="line">     <span class="variable language_">console</span>.<span class="title function_">log</span>(result)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<h5 id="8-11-3直接使用axios发起请求"><a href="#8-11-3直接使用axios发起请求" class="headerlink" title="8.11.3直接使用axios发起请求"></a>8.11.3直接使用<code>axios</code>发起请求</h5><p><code>axios</code> 也提供了类似于 <code>jQuery</code> 中 <code>$.ajax()</code> 的函数，语法如下：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">axios</span>(&#123;</span><br><span class="line"> <span class="attr">method</span>: <span class="string">&#x27;请求类型&#x27;</span>,</span><br><span class="line"> <span class="attr">url</span>: <span class="string">&#x27;请求的URL地址&#x27;</span>,</span><br><span class="line"> <span class="attr">data</span>: &#123; <span class="comment">/* POST数据 */</span> &#125;,</span><br><span class="line"> <span class="attr">params</span>: &#123; <span class="comment">/* GET参数 */</span> &#125;</span><br><span class="line">&#125;).<span class="title function_">then</span>(callback)</span><br></pre></td></tr></table></figure>

<p><strong>发起get请求</strong></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;#btn3&#x27;</span>).<span class="title function_">addEventListener</span>(<span class="string">&#x27;click&#x27;</span>, <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">      <span class="keyword">var</span> url = <span class="string">&#x27;http://www.liulongbin.top:3006/api/get&#x27;</span></span><br><span class="line">      <span class="keyword">var</span> paramsData = &#123; <span class="attr">name</span>: <span class="string">&#x27;钢铁侠&#x27;</span>, <span class="attr">age</span>: <span class="number">35</span> &#125;</span><br><span class="line">      <span class="title function_">axios</span>(&#123;</span><br><span class="line">        <span class="attr">method</span>: <span class="string">&#x27;GET&#x27;</span>,</span><br><span class="line">        <span class="attr">url</span>: url,</span><br><span class="line">        <span class="attr">params</span>: paramsData</span><br><span class="line">      &#125;).<span class="title function_">then</span>(<span class="keyword">function</span> (<span class="params">res</span>) &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(res.<span class="property">data</span>)</span><br><span class="line">      &#125;)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<p><strong>发起post请求</strong></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;#btn4&#x27;</span>).<span class="title function_">addEventListener</span>(<span class="string">&#x27;click&#x27;</span>, <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">  <span class="title function_">axios</span>(&#123;</span><br><span class="line">    <span class="attr">method</span>: <span class="string">&#x27;POST&#x27;</span>,</span><br><span class="line">    <span class="attr">url</span>: <span class="string">&#x27;http://www.liulongbin.top:3006/api/post&#x27;</span>,</span><br><span class="line">    <span class="attr">data</span>: &#123;</span><br><span class="line">      <span class="attr">name</span>: <span class="string">&#x27;娃哈哈&#x27;</span>,</span><br><span class="line">      <span class="attr">age</span>: <span class="number">18</span>,</span><br><span class="line">      <span class="attr">gender</span>: <span class="string">&#x27;女&#x27;</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;).<span class="title function_">then</span>(<span class="keyword">function</span> (<span class="params">res</span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(res.<span class="property">data</span>)</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<h3 id="9-同源策略"><a href="#9-同源策略" class="headerlink" title="9-同源策略"></a>9-同源策略</h3><h4 id="9-1同源策略（英文全称-Same-origin-policy）"><a href="#9-1同源策略（英文全称-Same-origin-policy）" class="headerlink" title="9.1同源策略（英文全称 Same origin policy）"></a><strong>9.1同源策略</strong>（英文全称 Same origin policy）</h4><p>是<strong>浏览器</strong>提供的一个<strong>安全功能</strong></p>
<p><strong><code>MDN</code> 官方给定的概念</strong>：同源策略限制了从同一个源加载的文档或脚本如何与来自另一个源的资源进行交互。这</p>
<p>是一个用于隔离潜在恶意文件的重要安全机制</p>
<p>通俗的理解：浏览器规定，A 网站的 JavaScript，不允许和非同源的网站 C 之间，进行资源的交互，例如：</p>
<p>① 无法读取非同源网页的 Cookie、LocalStorage 和 IndexedDB</p>
<p>② 无法接触非同源网页的 DOM</p>
<p>③ 无法向非同源地址发送 Ajax 请求</p>
<h4 id="9-2跨域"><a href="#9-2跨域" class="headerlink" title="9.2跨域"></a>9.2跨域</h4><p><strong>同源</strong>指的是两个 URL 的协议、域名、端口一致，反之，则是<strong>跨域</strong></p>
<p>出现跨域的根本原因：<strong>浏览器的同源策略</strong>不允许非同源的 URL 之间进行资源的交互</p>
<p><strong>注意：</strong>浏览器允许发起跨域请求，但是，跨域请求回来的数据，会被浏览器拦截，无法被页面获取到！</p>
<h4 id="9-3如何实现跨域数据请求"><a href="#9-3如何实现跨域数据请求" class="headerlink" title="9.3如何实现跨域数据请求"></a>9.3如何实现跨域数据请求</h4><p>现如今，实现跨域数据请求，最主要的两种解决方案，分别是 <code>JSONP</code> 和 <code>CORS</code>。</p>
<p><strong><code>JSONP</code>：</strong>出现的早，兼容性好（兼容低版本IE）。是前端程序员为了解决跨域问题，被迫想出来的一种临时解决方案。<strong>缺点</strong>是只支持 <code>GET</code> 请求，不支持 <code>POST</code> 请求。</p>
<p><strong><code>CORS</code>：</strong>出现的较晚，它是 <code>W3C</code> 标准，属于跨域 <code>Ajax</code> 请求的根本解决方案。支持 <code>GET</code> 和 <code>POST</code> 请求。<strong>缺点</strong>是不兼容某些低版本的浏览器</p>
<h4 id="9-4JSONP"><a href="#9-4JSONP" class="headerlink" title="9.4JSONP"></a>9.4<code>JSONP</code></h4><p><code>JSONP</code> (<code>JSON with Padding</code>) 是 <code>JSON</code> 的一种“使用模式”，可用于解决主流浏览器的跨域数据访问的问题。</p>
<h5 id="9-4-1JSONP的实现原理"><a href="#9-4-1JSONP的实现原理" class="headerlink" title="9.4.1JSONP的实现原理"></a>9.4.1<code>JSONP</code>的实现原理</h5><p>由于浏览器同源策略的限制，网页中无法通过 Ajax 请求非同源的接口数据。但是 <code>&lt;script&gt;</code> 标签不受浏览器同</p>
<p>源策略的影响，可以通过 <code>src</code> 属性，请求非同源的 <code>js</code> 脚本。</p>
<p>因此，<code>JSONP</code> 的实现原理，就是通过 <code>&lt;script&gt;</code> 标签的 <code>src</code> 属性，请求跨域的数据接口，并通过<strong>函数调用</strong>的形式，接收跨域接口响应回来的数据</p>
<h5 id="9-4-2自己实现一个简单的JSONP"><a href="#9-4-2自己实现一个简单的JSONP" class="headerlink" title="9.4.2自己实现一个简单的JSONP"></a>9.4.2自己实现一个简单的<code>JSONP</code></h5><p>定义一个<code>success</code>回调函数：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">function</span> <span class="title function_">success</span>(<span class="params">data</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;获取到了data数据：&#x27;</span>)</span></span><br><span class="line"><span class="language-javascript">    <span class="variable language_">console</span>.<span class="title function_">log</span>(data)</span></span><br><span class="line"><span class="language-javascript">    &#125;</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>通过 <code>&lt;script&gt;</code> 标签，请求接口数据：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;http://ajax.frontend.itheima.net:3006/api/jsonp?callback=success&amp;name=zs&amp;a</span></span></span><br><span class="line"><span class="string"><span class="tag">ge=20&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h5 id="9-4-3JSONP的缺点"><a href="#9-4-3JSONP的缺点" class="headerlink" title="9.4.3JSONP的缺点"></a>9.4.3<code>JSONP</code>的缺点</h5><p>由于 <code>JSONP</code> 是通过 <code>&lt;script&gt;</code> 标签的 <code>src</code> 属性，来实现跨域数据获取的，所以，<code>JSONP</code> 只支持 <code>GET</code> 数据请求，不支持 POST 请求。</p>
<p><strong>注意：</strong> <strong><code>JSONP</code> 和 Ajax 之间没有任何关系</strong>，不能把 <code>JSONP</code> 请求数据的方式叫做 Ajax，因为 <code>JSONP</code> 没有用到</p>
<p><code>XMLHttpRequest</code> 这个对象</p>
<h5 id="9-4-4jQuery中的JSONP"><a href="#9-4-4jQuery中的JSONP" class="headerlink" title="9.4.4jQuery中的JSONP"></a>9.4.4<code>jQuery</code>中的<code>JSONP</code></h5><p><code>jQuery</code> 提供的 <code>$.ajax()</code> 函数，除了可以发起真正的 <code>Ajax</code> 数据请求之外，还能够发起 <code>JSONP</code> 数据请求，例如：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">$.<span class="title function_">ajax</span>(&#123;</span><br><span class="line">     <span class="attr">url</span>: <span class="string">&#x27;http://ajax.frontend.itheima.net:3006/api/jsonp?name=zs&amp;age=20&#x27;</span>,</span><br><span class="line">     <span class="comment">// 如果要使用 $.ajax() 发起 JSONP 请求，必须指定 datatype 为 jsonp</span></span><br><span class="line">     <span class="attr">dataType</span>: <span class="string">&#x27;jsonp&#x27;</span>,</span><br><span class="line">     <span class="attr">success</span>: <span class="keyword">function</span>(<span class="params">res</span>) &#123;</span><br><span class="line">     <span class="variable language_">console</span>.<span class="title function_">log</span>(res)</span><br><span class="line">     &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<p>默认情况下，使用 <code>jQuery</code> 发起 <code>JSONP</code> 请求，会自动携带一个 c<code>allback=jQueryxxx</code> 的参数，<code>jQueryxxx</code> 是随机生成的一个回调函数名称</p>
<h5 id="9-4-5自定义参数及回调函数名称"><a href="#9-4-5自定义参数及回调函数名称" class="headerlink" title="9.4.5自定义参数及回调函数名称"></a>9.4.5自定义参数及回调函数名称</h5><p>在使用 <code>jQuery</code> 发起 <code>JSONP</code> 请求时，如果想要自定义 <code>JSONP</code> 的<strong>参数</strong>以及<strong>回调函数名称</strong>，可以通过如下两个参数来指定：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">$.<span class="title function_">ajax</span>(&#123;</span><br><span class="line">     <span class="attr">url</span>: <span class="string">&#x27;http://ajax.frontend.itheima.net:3006/api/jsonp?name=zs&amp;age=20&#x27;</span>,</span><br><span class="line">     <span class="attr">dataType</span>: <span class="string">&#x27;jsonp&#x27;</span>,</span><br><span class="line">     <span class="comment">// 发送到服务端的参数名称，默认值为 callback</span></span><br><span class="line">     <span class="attr">jsonp</span>: <span class="string">&#x27;callback&#x27;</span>,</span><br><span class="line">     <span class="comment">// 自定义的回调函数名称，默认值为 jQueryxxx 格式</span></span><br><span class="line">     <span class="attr">jsonpCallback</span>: <span class="string">&#x27;abc&#x27;</span>,</span><br><span class="line">     <span class="attr">success</span>: <span class="keyword">function</span>(<span class="params">res</span>) &#123;</span><br><span class="line">     <span class="variable language_">console</span>.<span class="title function_">log</span>(res)</span><br><span class="line">     &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<h5 id="9-4-6jQuery中JSONP的实现过程"><a href="#9-4-6jQuery中JSONP的实现过程" class="headerlink" title="9.4.6jQuery中JSONP的实现过程"></a>9.4.6<code>jQuery</code>中<code>JSONP</code>的实现过程</h5><p><code>jQuery</code> 中的 <code>JSONP</code>，也是通过 <code>&lt;script&gt;</code> 标签的 <code>src</code> 属性实现跨域数据访问的，只不过，<code>jQuery</code> 采用的是<strong>动态创建和移除标签</strong>的方式，来发起 <code>JSONP</code> 数据请求。</p>
<ul>
<li>在发起 <code>JSONP</code> 请求的时候，动态向 <code>&lt;header&gt;</code> 中 append 一个 <code>&lt;script&gt;</code> 标签；</li>
<li>在 <code>JSONP</code> 请求成功以后，动态从 <code>&lt;header&gt;</code> 中移除刚才 <code>append</code> 进去的 <code>&lt;script&gt;</code> 标签；</li>
</ul>
<p><strong>案例-淘宝搜索框</strong></p>
<p><strong>获取用户输入的搜索关键词</strong></p>
<p>为了获取到用户每次按下键盘输入的内容，需要监听输入框的 <code>keyup</code> 事件，示例代码如下：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 监听文本框的 keyup 事件</span></span><br><span class="line">$(<span class="string">&#x27;#ipt&#x27;</span>).<span class="title function_">on</span>(<span class="string">&#x27;keyup&#x27;</span>, <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">     <span class="comment">// 获取用户输入的内容</span></span><br><span class="line">     <span class="keyword">var</span> keywords = $(<span class="variable language_">this</span>).<span class="title function_">val</span>().<span class="title function_">trim</span>()</span><br><span class="line">     <span class="comment">// 判断用户输入的内容是否为空</span></span><br><span class="line">     <span class="keyword">if</span> (keywords.<span class="property">length</span> &lt;= <span class="number">0</span>) &#123;</span><br><span class="line">     <span class="keyword">return</span></span><br><span class="line">     &#125;</span><br><span class="line">     <span class="comment">// TODO：获取搜索建议列表</span></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<p><strong>封装<code>getSuggestList</code>函数</strong></p>
<p>将获取搜索建议列表的代码，封装到 <code>getSuggestList</code> 函数中，示例代码如下：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">getSuggestList</span>(<span class="params">kw</span>) &#123;</span><br><span class="line">     $.<span class="title function_">ajax</span>(&#123;</span><br><span class="line">     <span class="comment">// 指定请求的 URL 地址，其中，q 是用户输入的关键字</span></span><br><span class="line">     <span class="attr">url</span>: <span class="string">&#x27;https://suggest.taobao.com/sug?q=&#x27;</span> + kw,</span><br><span class="line">     <span class="comment">// 指定要发起的是 JSONP 请求</span></span><br><span class="line">     <span class="attr">dataType</span>: <span class="string">&#x27;jsonp&#x27;</span>,</span><br><span class="line">     <span class="comment">// 成功的回调函数</span></span><br><span class="line">     <span class="attr">success</span>: <span class="keyword">function</span>(<span class="params">res</span>) &#123; <span class="variable language_">console</span>.<span class="title function_">log</span>(res) &#125;</span><br><span class="line">     &#125;)</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure>

<p><strong>渲染建议列表的<code>UI</code>结构</strong></p>
<p><strong>定义搜索建议列表</strong></p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;box&quot;</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- tab 栏区域 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;tabs&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 搜索区域 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;search-box&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 搜索建议列表 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;suggest-list&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p><strong>定义模板结构</strong></p>
<ul>
<li>创建<code>script</code>标签</li>
<li>设置<code>type</code>属性为 <code>text/html</code> 设置模板<code>id</code></li>
<li>利用 <code>each</code> 遍历结构</li>
</ul>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 模板结构 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">&quot;text/html&quot;</span> <span class="attr">id</span>=<span class="string">&quot;tpl-suggestList&quot;</span>&gt;</span><span class="language-handlebars"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-xml"><span class="language-handlebars">     </span><span class="template-variable">&#123;&#123;<span class="name"><span class="built_in">each</span></span> result&#125;&#125;</span><span class="language-xml"></span></span></span><br><span class="line"><span class="language-xml"><span class="language-handlebars">     <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;suggest-item&quot;</span>&gt;</span></span><span class="template-variable">&#123;&#123;<span class="name">$value</span>[0]&#125;&#125;</span><span class="language-xml"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span></span><br><span class="line"><span class="language-xml"><span class="language-handlebars">     </span><span class="template-tag">&#123;&#123;/<span class="name"><span class="built_in">each</span></span>&#125;&#125;</span><span class="language-xml"></span></span></span><br><span class="line"><span class="language-xml"><span class="language-handlebars"></span></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p><strong>定义渲染模板结构的函数</strong></p>
<ul>
<li>定义函数，接收一个参数，就是服务器返回的数据</li>
<li>判断返回的数据长度是否大于0</li>
<li>如果没有，将页面的列表清空，并且进行隐藏</li>
<li>如果有数据，调用模板的 <code>template</code> 函数，传入<code>id</code>和数据</li>
<li>返回渲染好的<code>html</code>字符串，然后放入容器中</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"> <span class="comment">// 渲染建议列表</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">renderSuggestList</span>(<span class="params">res</span>) &#123;</span><br><span class="line">     <span class="comment">// 如果没有需要渲染的数据，则直接 return</span></span><br><span class="line">     <span class="keyword">if</span> (res.<span class="property">result</span>.<span class="property">length</span> &lt;= <span class="number">0</span>) &#123;</span><br><span class="line">     <span class="keyword">return</span> $(<span class="string">&#x27;#suggest-list&#x27;</span>).<span class="title function_">empty</span>().<span class="title function_">hide</span>()</span><br><span class="line">     &#125;</span><br><span class="line">     <span class="comment">// 渲染模板结构</span></span><br><span class="line">     <span class="keyword">var</span> htmlStr = <span class="title function_">template</span>(<span class="string">&#x27;tpl-suggestList&#x27;</span>, res)</span><br><span class="line">     $(<span class="string">&#x27;#suggest-list&#x27;</span>).<span class="title function_">html</span>(htmlStr).<span class="title function_">show</span>()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>搜索关键词为空时隐藏搜索建议列表</strong></p>
<ul>
<li>注册<code>keyup</code>事件</li>
<li>判断输入框的内容是否为空</li>
<li>如果为空隐藏列表</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">$(<span class="string">&#x27;#ipt&#x27;</span>).<span class="title function_">on</span>(<span class="string">&#x27;keyup&#x27;</span>, <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">     <span class="comment">// 获取用户输入的内容</span></span><br><span class="line">     <span class="keyword">var</span> keywords = $(<span class="variable language_">this</span>).<span class="title function_">val</span>().<span class="title function_">trim</span>()</span><br><span class="line">     <span class="comment">// 判断用户输入的内容是否为空</span></span><br><span class="line">     <span class="keyword">if</span> (keywords.<span class="property">length</span> &lt;= <span class="number">0</span>) &#123;</span><br><span class="line">     <span class="comment">// 如果关键词为空，则清空后隐藏搜索建议列表</span></span><br><span class="line">     <span class="keyword">return</span> $(<span class="string">&#x27;#suggest-list&#x27;</span>).<span class="title function_">empty</span>().<span class="title function_">hide</span>()</span><br><span class="line">     &#125;</span><br><span class="line">     <span class="title function_">getSuggestList</span>(keywords)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<h3 id="10-防抖-amp-节流"><a href="#10-防抖-amp-节流" class="headerlink" title="10-防抖&amp;节流"></a>10-防抖&amp;节流</h3><h4 id="10-1什么是防抖"><a href="#10-1什么是防抖" class="headerlink" title="10.1什么是防抖"></a>10.1什么是防抖</h4><p><strong>防抖策略</strong>（<code>debounce</code>）是当事件被触发后，延迟 <code>n</code> 秒后再执行回调，如果在这 <code>n</code> 秒内事件又被触发，则重新计时。</p>
<p><strong>好处：</strong>能够保证用户在频繁触发某些事件的时候，不会频繁的执行回调，只会被执行一次</p>
<h5 id="防抖的应用场景"><a href="#防抖的应用场景" class="headerlink" title="防抖的应用场景"></a>防抖的应用场景</h5><p>用户在输入框中连续输入一串字符时，可以通过防抖策略，只在输入完后，才执行查询的请求，这样可以有效减</p>
<p>少请求次数，节约请求资源；</p>
<p>实现输入框的防抖</p>
<ul>
<li>防抖动的 timer</li>
<li>定义防抖的函数，函数里面定义一个延时器，在演示器里面调用发起<code>JSONP</code>的请求</li>
<li>在触发 <code>keyup</code> 事件时，立即清空 <code>timer</code>，然后调用防抖的函数</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> timer = <span class="literal">null</span> <span class="comment">// 1. 防抖动的 timer</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">debounceSearch</span>(<span class="params">keywords</span>) &#123; <span class="comment">// 2. 定义防抖的函数</span></span><br><span class="line">     timer = <span class="built_in">setTimeout</span>(<span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">     <span class="comment">// 发起 JSONP 请求</span></span><br><span class="line">     <span class="title function_">getSuggestList</span>(keywords)</span><br><span class="line">     &#125;, <span class="number">500</span>)</span><br><span class="line"> &#125;</span><br><span class="line">$(<span class="string">&#x27;#ipt&#x27;</span>).<span class="title function_">on</span>(<span class="string">&#x27;keyup&#x27;</span>, <span class="keyword">function</span>(<span class="params"></span>) &#123; <span class="comment">// 3. 在触发 keyup 事件时，立即清空 timer</span></span><br><span class="line"> <span class="built_in">clearTimeout</span>(timer)</span><br><span class="line"> <span class="comment">// ...省略其他代码</span></span><br><span class="line"> <span class="title function_">debounceSearch</span>(keywords)</span><br><span class="line"> &#125;)</span><br></pre></td></tr></table></figure>

<p>缓存搜索的建议列表</p>
<p>定义全局缓存对象</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 缓存对象</span></span><br><span class="line"><span class="keyword">var</span> cacheObj = &#123;&#125;</span><br></pre></td></tr></table></figure>

<p>将搜索结果保存到缓存对象中</p>
<ul>
<li>键就是用户输入的关键字，值就是服务器返回的value</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 渲染建议列表</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">renderSuggestList</span>(<span class="params">res</span>) &#123;</span><br><span class="line">     <span class="comment">// ...省略其他代码</span></span><br><span class="line">     <span class="comment">// 将搜索的结果，添加到缓存对象中</span></span><br><span class="line">     <span class="keyword">var</span> k = $(<span class="string">&#x27;#ipt&#x27;</span>).<span class="title function_">val</span>().<span class="title function_">trim</span>()</span><br><span class="line">     cacheObj[k] = res</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>优先从缓存中获取搜索建议</p>
<ul>
<li>在发起请求之前，先判断缓存中是否有数据</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 监听文本框的 keyup 事件</span></span><br><span class="line">$(<span class="string">&#x27;#ipt&#x27;</span>).<span class="title function_">on</span>(<span class="string">&#x27;keyup&#x27;</span>, <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">     <span class="comment">// ...省略其他代码</span></span><br><span class="line">     <span class="comment">// 优先从缓存中获取搜索建议</span></span><br><span class="line">     <span class="keyword">if</span> (cacheObj[keywords]) &#123;</span><br><span class="line">     <span class="keyword">return</span> <span class="title function_">renderSuggestList</span>(cacheObj[keywords])</span><br><span class="line">     &#125;</span><br><span class="line">     <span class="comment">// 获取搜索建议列表</span></span><br><span class="line">     <span class="title function_">debounceSearch</span>(keywords)</span><br><span class="line"> &#125;)</span><br></pre></td></tr></table></figure>

<h4 id="10-2节流"><a href="#10-2节流" class="headerlink" title="10.2节流"></a>10.2节流</h4><h5 id="10-2-1什么是节流"><a href="#10-2-1什么是节流" class="headerlink" title="10.2.1什么是节流"></a>10.2.1什么是节流</h5><p><strong>节流策略</strong>（<code>throttle</code>），顾名思义，可以减少一段时间内事件的触发频率。</p>
<h5 id="10-2-2节流的应用场景"><a href="#10-2-2节流的应用场景" class="headerlink" title="10.2.2节流的应用场景"></a>10.2.2节流的应用场景</h5><p>① 鼠标连续不断地触发某事件（如点击），只在单位时间内只触发一次；</p>
<p>② 懒加载时要监听计算滚动条的位置，但不必每次滑动都触发，可以降低计算的频率，而不必去浪费 CPU 资源；</p>
<h5 id="10-2-3节流案例-–-鼠标跟随效果"><a href="#10-2-3节流案例-–-鼠标跟随效果" class="headerlink" title="10.2.3节流案例 – 鼠标跟随效果"></a><strong>10.2.3节流案例</strong> <strong>–</strong> 鼠标跟随效果</h5><h6 id="UI效果"><a href="#UI效果" class="headerlink" title="UI效果"></a><code>UI</code>效果</h6><h6 id="渲染UI结构并美化样式"><a href="#渲染UI结构并美化样式" class="headerlink" title="渲染UI结构并美化样式"></a>渲染<code>UI</code>结构并美化样式</h6><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- UI 结构 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&quot;./assets/angel.gif&quot;</span> <span class="attr">alt</span>=<span class="string">&quot;&quot;</span> <span class="attr">id</span>=<span class="string">&quot;angel&quot;</span> /&gt;</span></span><br><span class="line">/* CSS 样式 */</span><br><span class="line">html, body &#123;</span><br><span class="line"> margin: 0;</span><br><span class="line"> padding: 0;</span><br><span class="line"> overflow: hidden; &#125;</span><br><span class="line">#angel &#123;</span><br><span class="line"> position: absolute; &#125;</span><br></pre></td></tr></table></figure>

<h6 id="不使用节流时实现鼠标跟随效果"><a href="#不使用节流时实现鼠标跟随效果" class="headerlink" title="不使用节流时实现鼠标跟随效果"></a>不使用节流时实现鼠标跟随效果</h6><ul>
<li>获取图片元素</li>
<li>注册 <code>mousemove</code>事件</li>
<li>设置图片的位置</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">$(<span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">     <span class="comment">// 获取图片元素</span></span><br><span class="line">     <span class="keyword">var</span> angel = $(<span class="string">&#x27;#angel&#x27;</span>)</span><br><span class="line">     <span class="comment">// 监听文档的 mousemove 事件</span></span><br><span class="line">     $(<span class="variable language_">document</span>).<span class="title function_">on</span>(<span class="string">&#x27;mousemove&#x27;</span>, <span class="keyword">function</span>(<span class="params">e</span>) &#123;</span><br><span class="line">     <span class="comment">// 设置图片的位置</span></span><br><span class="line">     $(angel).<span class="title function_">css</span>(<span class="string">&#x27;left&#x27;</span>, e.<span class="property">pageX</span> + <span class="string">&#x27;px&#x27;</span>).<span class="title function_">css</span>(<span class="string">&#x27;top&#x27;</span>, e.<span class="property">pageY</span> + <span class="string">&#x27;px&#x27;</span>)</span><br><span class="line">     &#125;)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<h4 id="10-3节流阀的概念"><a href="#10-3节流阀的概念" class="headerlink" title="10.3节流阀的概念"></a>10.3节流阀的概念</h4><p>高铁卫生间是否被占用，由红绿灯控制，红灯表示被占用，绿灯表示可使用。</p>
<p>假设每个人上卫生间都需要花费5分钟，则五分钟之内，被占用的卫生间无法被其他人使用。</p>
<p>上一个人使用完毕后，需要将红灯<strong>重置</strong>为绿灯，表示下一个人可以使用卫生间。</p>
<p>下一个人在上卫生间之前，需要<strong>先判断控制灯</strong>是否为绿色，来知晓能否上卫生间。</p>
<p>节流阀为空，表示可以执行下次操作；不为空，表示不能执行下次操作。</p>
<p>当前操作执行完，必须将节流阀<strong>重置</strong>为空，表示可以执行下次操作了。</p>
<p>每次执行操作前，必须<strong>先判断节流阀是否为空</strong>。</p>
<h5 id="10-3-1使用节流优化鼠标跟随效果"><a href="#10-3-1使用节流优化鼠标跟随效果" class="headerlink" title="10.3.1使用节流优化鼠标跟随效果"></a>10.3.1使用节流优化鼠标跟随效果</h5><ul>
<li>预定义一个 timer <strong>节流阀</strong></li>
<li>当设置了鼠标跟随效果后，<strong>清空</strong> <strong>timer</strong> <strong>节流阀</strong>，方便下次开启延时器</li>
<li>执行事件的时候判断<strong>节流阀</strong>是否为空，如果不为空，则证明距离上次执行间隔不足16毫秒</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">$(<span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">     <span class="keyword">var</span> angel = $(<span class="string">&#x27;#angel&#x27;</span>)</span><br><span class="line">     <span class="keyword">var</span> timer = <span class="literal">null</span> <span class="comment">// 1.预定义一个 timer 节流阀</span></span><br><span class="line">     $(<span class="variable language_">document</span>).<span class="title function_">on</span>(<span class="string">&#x27;mousemove&#x27;</span>, <span class="keyword">function</span>(<span class="params">e</span>) &#123;</span><br><span class="line">     <span class="keyword">if</span> (timer) &#123; <span class="keyword">return</span> &#125; <span class="comment">// 3.判断节流阀是否为空，如果不为空，则证明距离上次执行间隔不足16毫秒</span></span><br><span class="line">     timer = <span class="built_in">setTimeout</span>(<span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">     $(angel).<span class="title function_">css</span>(<span class="string">&#x27;left&#x27;</span>, e.<span class="property">pageX</span> + <span class="string">&#x27;px&#x27;</span>).<span class="title function_">css</span>(<span class="string">&#x27;top&#x27;</span>, e.<span class="property">pageY</span> + <span class="string">&#x27;px&#x27;</span>)</span><br><span class="line">     timer = <span class="literal">null</span> <span class="comment">// 2.当设置了鼠标跟随效果后，清空 timer 节流阀，方便下次开启延时器</span></span><br><span class="line">     &#125;, <span class="number">16</span>)</span><br><span class="line">     &#125;)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<h4 id="10-4总结防抖和节流的区别"><a href="#10-4总结防抖和节流的区别" class="headerlink" title="10.4总结防抖和节流的区别"></a>10.4总结防抖和节流的区别</h4><ul>
<li><strong>防抖</strong>：如果事件被频繁触发，防抖能保证只有最有一次触发生效！前面 N 多次的触发都会被忽略！</li>
<li><strong>节流</strong>：如果事件被频繁触发，节流能够减少事件触发的频率，因此，节流是有选择性地执行一部分事件！</li>
</ul>

      
    </div>
    <div class="article-footer">
      <blockquote class="mt-2x">
  <ul class="post-copyright list-unstyled">
    
    <li class="post-copyright-link hidden-xs">
      <strong>本文链接：</strong>
      <a href="http://example.com/2022/11/06/%E5%88%9D%E8%AF%86-%E5%9B%9B/" title="初识(四)" target="_blank" rel="external">http://example.com/2022/11/06/初识-四/</a>
    </li>
    
    <li class="post-copyright-license">
      <strong>版权声明： </strong> 本博客所有文章除特别声明外，均采用 <a href="http://creativecommons.org/licenses/by/4.0/deed.zh" target="_blank" rel="external">CC BY 4.0 CN协议</a> 许可协议。转载请注明出处！
    </li>
  </ul>
</blockquote>


<div class="panel panel-default panel-badger">
  <div class="panel-body">
    <figure class="media">
      <div class="media-left">
        <a href="https://github.com/cofess" target="_blank" class="img-burn thumb-sm visible-lg">
          <img src="/images/portrait.jpg" class="img-rounded w-full" alt="">
        </a>
      </div>
      <div class="media-body">
        <h3 class="media-heading"><a href="https://github.com/cofess" target="_blank"><span class="text-dark">十七</span><small class="ml-1x">前端开发工程师</small></a></h3>
        <div>个人简介。</div>
      </div>
    </figure>
  </div>
</div>


    </div>
  </article>
  
    
  <section id="comments">
  	
      <div id="vcomments"></div>
    
  </section>


  
</div>

  <nav class="bar bar-footer clearfix" data-stick-bottom>
  <div class="bar-inner">
  
  <ul class="pager pull-left">
    
    <li class="prev">
      <a href="/2022/11/06/%E5%88%9D%E8%AF%86-%E4%BA%94/" title="初识(五)"><i class="icon icon-angle-left" aria-hidden="true"></i><span>&nbsp;&nbsp;上一篇</span></a>
    </li>
    
    
    <li class="next">
      <a href="/2022/11/06/%E5%88%9D%E8%AF%86-%E4%B8%89/" title="初识(三)"><span>下一篇&nbsp;&nbsp;</span><i class="icon icon-angle-right" aria-hidden="true"></i></a>
    </li>
    
    
  </ul>
  
  
  <!-- Button trigger modal -->
  <button type="button" class="btn btn-fancy btn-donate pop-onhover bg-gradient-warning" data-toggle="modal" data-target="#donateModal"><span>赏</span></button>
  <!-- <div class="wave-icon wave-icon-danger btn-donate" data-toggle="modal" data-target="#donateModal">
    <div class="wave-circle"><span class="icon"><i class="icon icon-bill"></i></span></div>
  </div> -->
  
  
  <div class="bar-right">
    
    <div class="share-component" data-sites="weibo,qq,wechat,facebook,twitter" data-mobile-sites="weibo,qq,qzone"></div>
    
  </div>
  </div>
</nav>
  
<!-- Modal -->
<div class="modal modal-center modal-small modal-xs-full fade" id="donateModal" tabindex="-1" role="dialog">
  <div class="modal-dialog" role="document">
    <div class="modal-content donate">
      <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
      <div class="modal-body">
        <div class="donate-box">
          <div class="donate-head">
            <p>感谢您的支持，我会继续努力的!</p>
          </div>
          <div class="tab-content">
            <div role="tabpanel" class="tab-pane fade active in" id="alipay">
              <div class="donate-payimg">
                <img src="/images/donate/zhifubao.jpg" alt="扫码支持" title="扫一扫" />
              </div>
              <p class="text-muted mv">扫码打赏，你说多少就多少</p>
              <p class="text-grey">打开支付宝扫一扫，即可进行扫码打赏哦</p>
            </div>
            <div role="tabpanel" class="tab-pane fade" id="wechatpay">
              <div class="donate-payimg">
                <img src="/images/donate/weixin.jpg" alt="扫码支持" title="扫一扫" />
              </div>
              <p class="text-muted mv">扫码打赏，你说多少就多少</p>
              <p class="text-grey">打开微信扫一扫，即可进行扫码打赏哦</p>
            </div>
          </div>
          <div class="donate-footer">
            <ul class="nav nav-tabs nav-justified" role="tablist">
              <li role="presentation" class="active">
                <a href="#alipay" id="alipay-tab" role="tab" data-toggle="tab" aria-controls="alipay" aria-expanded="true"><i class="icon icon-alipay"></i> 支付宝</a>
              </li>
              <li role="presentation" class="">
                <a href="#wechatpay" role="tab" id="wechatpay-tab" data-toggle="tab" aria-controls="wechatpay" aria-expanded="false"><i class="icon icon-wepay"></i> 微信支付</a>
              </li>
            </ul>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>



</main>

  <footer class="footer" itemscope itemtype="http://schema.org/WPFooter">
	
	
    <ul class="social-links">
    	
        <li><a href="https://github.com/cofess" target="_blank" title="Github" data-toggle=tooltip data-placement=top><i class="icon icon-github"></i></a></li>
        
        <li><a href="http://weibo.com/cofess" target="_blank" title="Weibo" data-toggle=tooltip data-placement=top><i class="icon icon-weibo"></i></a></li>
        
        <li><a href="https://twitter.com/iwebued" target="_blank" title="Twitter" data-toggle=tooltip data-placement=top><i class="icon icon-twitter"></i></a></li>
        
        <li><a href="https://www.behance.net/cofess" target="_blank" title="Behance" data-toggle=tooltip data-placement=top><i class="icon icon-behance"></i></a></li>
        
        <li><a href="/atom.xml" target="_blank" title="Rss" data-toggle=tooltip data-placement=top><i class="icon icon-rss"></i></a></li>
        
    </ul>

    <div class="copyright">
    	
        <div class="publishby">
        	Theme by <a href="https://github.com/cofess" target="_blank"> cofess </a>base on <a href="https://github.com/cofess/hexo-theme-pure" target="_blank">pure</a>.
        </div>
    </div>
</footer>
  <script src="//cdn.jsdelivr.net/npm/jquery@1.12.4/dist/jquery.min.js"></script>
<script>
window.jQuery || document.write('<script src="js/jquery.min.js"><\/script>')
</script>

<script src="/js/plugin.min.js"></script>


<script src="/js/application.js"></script>


    <script>
(function (window) {
    var INSIGHT_CONFIG = {
        TRANSLATION: {
            POSTS: '文章',
            PAGES: '页面',
            CATEGORIES: '分类',
            TAGS: '标签',
            UNTITLED: '(未命名)',
        },
        ROOT_URL: '/',
        CONTENT_URL: '/content.json',
    };
    window.INSIGHT_CONFIG = INSIGHT_CONFIG;
})(window);
</script>

<script src="/js/insight.js"></script>






   




   
    
  <script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script>
  <script src="//cdn.jsdelivr.net/npm/valine"></script>
  <script type="text/javascript">
  var GUEST = ['nick', 'mail', 'link'];
  var meta = 'nick,mail,link';
  meta = meta.split(',').filter(function(item) {
    return GUEST.indexOf(item) > -1;
  });
  new Valine({
    el: '#vcomments',
    verify: false,
    notify: false,
    appId: '',
    appKey: '',
    placeholder: 'Just go go',
    avatar: 'mm',
    meta: meta,
    pageSize: '10' || 10,
    visitor: false
  });
  </script>

     







</body>
</html>